<!DOCTYPE html>
<html lang=""><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>vista-complete-pc-backup-to-network-share</title>
    <meta name="description" content="The desk of my mind.">
    <meta name="author" content='John Burns'>

    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://johnburns.io/favicon.ico">
    

    
        
    
</head>

    <link rel="stylesheet" href="/syntax.css" crossorigin="anonymous">
    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0">
        <a class="navbar-brand mx-0 mr-sm-auto" href="https://johnburns.io/" title="The Colour of My Thoughts">
          
          The Colour of My Thoughts
        </a>
        <div class="navbar-nav flex-row flex-wrap justify-content-center">
            
                
                
                    <a class="nav-item nav-link" href="/about/" title="About">
                        About
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/resume.pdf" title="Resume">
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-earmark-person-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M2 2a2 2 0 0 1 2-2h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm7.5 1.5v-2l3 3h-2a1 1 0 0 1-1-1zM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm2 5.755S12 12 8 12s-5 1.755-5 1.755V14a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-.245z"/></svg> Resume
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/contact/" title="Contact">
                        Contact
                    </a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<div class="container">
    <h2 id="vista-complete-pc-backup-to-network-share">Vista Complete-PC backup to network share</h2>
<p>The real magic of the new Vista backup tool is the second option Complete-PC backup. This feature takes advantage of the HAL independence of Vista and allows you to backup your entire system at one time using the magic of volume shadow copies to backup open files. The backup is also stored in a virtual machine file which means that you can boot, run, and extract files from your backup using Microsoft Virtual PC. This is a really neat feature! If the previous feature isn�t enough for you Microsoft will let you restore your pc by booting to the Windows Vista install DVD and selecting the restore option.</p>
<p>This is the greatest reason to use the new Windows complete-pc backup feature over other third party backup solutions. As it lets you restore you pc intact with all software serial codes and files ready to rock. However Microsoft in their wisdom has added some obstacles to using what would otherwise be a great tool. When you select the complete pc backup feature you are not given the option to backup to a network drive. This is a big problem as most people do not have a spare hard drive sitting in their desktops waiting for a backup. It is also a problem from an IT administrative viewpoint. As an administrator I would like to have 1 centralized location to store all of my client PC backups. This is also a problem for people at home with nas storage devices as they may have opted for 1 drive without partitions as they expected to keep all backups and data files on the nas drive.</p>
<p>In order to get around this problem Microsoft has provided a command line version of the windows backup utility called <strong>wbadmin.exe.</strong> This version of the utility is far more powerful than the generic GUI version intended for typical users and allows you to backup to a network drive among other things. Remember that although you can backup to a network drive the backup file must be on a local drive it is to be used by the  <strong>Windows bootable CD</strong> to restore the drive!Lets take a quick look at the switches available to us on the CLI version of the utility, but first lets cover a few caveats. The command line version of the utility does not prompt for credentials, it attempts to access the network share using the credentials of the current user. This means that if you are not backing up to a windows domain member server, in the case of a consumer Linux powered NAS drive, then you must have an account on the nas box that has the same username and password as you are using on the Vista machine. The CLI version of the command must be run from an elevated command window.Let�s take a look at the utility now that we have covered the basics.C:\Users\John&gt;wbadmin.exewbadmin 1.0 - Backup command-line tool(C) Copyright 2004 Microsoft Corp.ERROR - Command incomplete. See list below.For more help, type wbadmin &lt;command&gt; -help&mdash;- Commands Supported &mdash;-START BACKUP &ndash; Run a backup immediatelySTOP JOB &ndash; Stop currently running backup or recoveryGET VERSIONS &ndash; List details backups recoverable fromGET ITEMS &ndash; Lists items backed up for a backupGET STATUS &ndash; Lists status of currently running job</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">C</span><span class="o">:</span><span class="err">\</span><span class="nx">Users</span><span class="err">\</span><span class="nx">John</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">C</span><span class="o">:</span><span class="err">\</span><span class="nx">Windows</span><span class="err">\</span><span class="nx">system32</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nx">wbadmin</span> <span class="nx">start</span> <span class="nx">backup</span> <span class="o">-</span><span class="nx">backuptarget</span><span class="o">:</span><span class="err">\\</span><span class="nx">server</span><span class="err">\</span><span class="nx">share</span><span class="err">\</span> <span class="o">-</span><span class="nx">include</span> <span class="o">**</span> <span class="o">**:</span><span class="nx">c</span><span class="o">:</span> <span class="o">-</span><span class="nx">drive</span> <span class="nx">letter</span> <span class="nx">to</span> <span class="nx">backup</span> <span class="o">**</span><span class="nx">wbadmin</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="nx">Backup</span> <span class="nx">command</span><span class="o">-</span><span class="nx">line</span> <span class="nx">tool</span><span class="p">(</span><span class="nx">C</span><span class="p">)</span> <span class="nx">Copyright</span> <span class="mi">2004</span> <span class="nx">Microsoft</span> <span class="nx">Corp</span><span class="p">.</span><span class="nx">Retrieving</span> <span class="nx">volume</span> <span class="nx">information</span><span class="p">...</span><span class="nx">This</span> <span class="nx">would</span> <span class="nx">backup</span> <span class="nx">volume</span> <span class="nx">Local</span> <span class="nx">Disk</span><span class="p">(</span><span class="nx">C</span><span class="o">:</span><span class="p">)</span> <span class="nx">to</span> <span class="err">\\</span><span class="nx">server</span><span class="err">\</span><span class="nx">share</span><span class="err">\</span><span class="p">.</span><span class="nx">Do</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">start</span> <span class="nx">the</span> <span class="nx">backup</span> <span class="nx">operation</span><span class="o">?</span><span class="p">[</span><span class="nx">Y</span><span class="p">]</span> <span class="nx">Yes</span> <span class="p">[</span><span class="nx">N</span><span class="p">]</span> <span class="nx">No</span> <span class="nx">yBackup</span> <span class="nx">to</span> <span class="err">\\</span><span class="nx">server</span><span class="err">\</span><span class="nx">share</span><span class="err">\</span> <span class="nx">is</span> <span class="nx">starting</span><span class="p">.</span><span class="nx">Running</span> <span class="nx">shadow</span> <span class="nx">copy</span> <span class="k">of</span> <span class="nx">volumes</span> <span class="nx">requested</span> <span class="k">for</span> <span class="nx">backup</span><span class="p">.</span><span class="nx">Running</span> <span class="nx">shadow</span> <span class="nx">copy</span> <span class="k">of</span> <span class="nx">volumes</span> <span class="nx">requested</span> <span class="k">for</span> <span class="nx">backup</span><span class="p">.</span>
</span></span></code></pre></div>
</div>

        </div><div id="footer" class="mb-5">
    <hr>
    
    <div class="container text-center">
        
            <a href="https://twitter.com/" class="fab fa-twitter fa-1x" title="Twitter"></a>
        
            <a href="mailto:john@techinvasion.net" class="fas fa-envelope fa-1x" title="E-mail"></a>
        
    </div>
    
    
        <div class="container text-center">
            <a href="https://github.com/bufo333/" title="By John Burns"><small>By John Burns</small></a>
        </div>
    
</div>
</body>
</html>
