[{"categories":null,"contents":"This guide explains how to transform a fresh installation of Raspberry Pi OS into a stratum‑1 NTP server. The project leverages a GPIO‑based GPS module with PPS, the PTP hardware timestamping capability of the Ethernet interface, Chrony for NTP synchronization, and Telegraf with InfluxDB for monitoring.\n1. Overview In this project you\u0026rsquo;ll build a stratum‑1 NTP server using:\nRaspberry Pi 5 as the host. A GPS module (via the serial UART port) for an absolute time reference. A PPS (Pulse Per Second) signal from the same GPS for sub-microsecond timing accuracy. The PTP hardware timestamping on the Ethernet interface for improved precision on PTP packets. Chrony for NTP time synchronization. gpsd to interface with your GPS receiver. Telegraf for monitoring various metrics (including Chrony statistics) sent to an InfluxDB backend. 2. Prerequisites and Required Hardware Before you begin, ensure you have the following:\nRaspberry Pi 5 running a fresh install of Raspberry Pi OS. A GPS module with serial (UART) output and PPS capability. An external GPIO connection for the PPS signal (typically connected to a dedicated GPIO pin, e.g. GPIO4). An Ethernet interface with PTP hardware timestamping support. A monitoring server running InfluxDB (or you can install InfluxDB locally if desired). 3. Software Packages to Install For a fully functional stratum‑1 NTP server, you\u0026rsquo;ll need to install these packages:\nchrony – Provides the NTP daemon with support for hardware timestamping and refclock interfaces. gpsd – Daemon to interact with your GPS device. gpsd-clients – Utilities to query the GPS data. telegraf – For gathering system and application metrics and sending them to InfluxDB. ethtool – For inspecting and verifying hardware timestamping support on the Ethernet interface. (Optionally) pps-tools – To assist with troubleshooting PPS signals. Install these packages using:\nsudo apt update sudo apt install chrony gpsd gpsd-clients telegraf ethtool pps-tools 4. Kernel and Firmware Configuration To properly use the GPIO PPS and enable the UART for your GPS, update your boot configuration and load the required kernel modules.\n4.1. Modify the Boot Configuration Edit the /boot/firmware/config.txt file to enable the UART and configure the PPS overlay (using GPIO4):\n[all] dtparam=uart0=on dtoverlay=pps-gpio,gpiopin=4 dtoverlay=disable-wifi 4.2. Ensure Kernel Modules Load at Boot Edit /etc/modules to load the necessary kernel modules:\n#/etc/modules: kernel modules to load at boot time. pps-gpio i2c-dev This configuration ensures the PPS GPIO module and I2C support (if needed) are loaded during boot.\n5. Configuring gpsd Configure gpsd to start at boot and use the correct devices. Edit /etc/default/gpsd as follows:\n# Devices gpsd should collect to at boot time. DEVICES=\u0026#34;/dev/ttyAMA0 /dev/pps0\u0026#34; # Other options you want to pass to gpsd GPSD_OPTIONS=\u0026#34;-n\u0026#34; # Automatically hot add/remove USB GPS devices via gpsdctl USBAUTO=\u0026#34;true\u0026#34; This configuration tells gpsd to open the UART device (for NMEA data from the GPS) and the PPS device for precise pulse timing.\n6. Configuring Chrony Chrony will serve as your NTP daemon. Its configuration utilizes the GPS and PPS refclocks and leverages PTP hardware timestamping on the Ethernet interface.\nEdit /etc/chrony/chrony.conf to include:\nconfdir /etc/chrony/conf.d server 0.us.pool.ntp.org iburst server 1.us.pool.ntp.org iburst server 2.us.pool.ntp.org iburst server 3.us.pool.ntp.org iburst keyfile /etc/chrony/chrony.keys driftfile /var/lib/chrony/chrony.drift ntsdumpdir /var/lib/chrony #log tracking measurements statistics logdir /var/log/chrony maxupdateskew 100.0 rtcsync makestep 1 3 leapsectz right/UTC refclock SOCK /run/chrony.ttyAMA0.sock refid GPS precision 1e-3 noselect refclock SOCK /run/chrony.pps0.sock refid PPS precision 1e-7 lock GPS allow 192.168.109.0/24 allow fd79:605:8025:a109::/64 ptpport 319 hwtimestamp * Key Points:\nRefclock SOCK entries: These specify the Unix sockets where Chrony receives data from gpsd (for the serial GPS) and the PPS signal. PTP support: The ptpport 319 and hwtimestamp * lines enable PTP hardware timestamping, which improves timing accuracy. Network access: The allow lines configure which subnets may query your NTP server. 7. Verifying PTP Hardware Timestamping To verify that your Ethernet interface supports hardware timestamping, run:\nethtool -T eth0 The output should indicate support for hardware transmit/receive timestamps and include details similar to:\nPTP Hardware Clock: 0 Hardware Transmit Timestamp Modes: off on onestep-sync Hardware Receive Filter Modes: none all This confirms that your interface is correctly configured for precise timestamping.\n8. Configuring Telegraf for Monitoring Telegraf collects and sends system metrics to your InfluxDB instance. Edit /etc/telegraf/telegraf.conf to monitor Chrony statistics, GPS data, and general system metrics:\n## Minimal telegraf.conf for monitoring a Raspberry Pi with gpsd, chrony, and full system metrics [agent] interval = \u0026#34;10s\u0026#34; round_interval = true metric_batch_size = 1000 metric_buffer_limit = 10000 collection_jitter = \u0026#34;0s\u0026#34; flush_interval = \u0026#34;10s\u0026#34; flush_jitter = \u0026#34;0s\u0026#34; debug = false quiet = false [[outputs.influxdb]] ## URL of your InfluxDB instance using HTTPS urls = [\u0026#34;https://192.168.109.7:8086\u0026#34;] ## Ignore certificate chain and host verification (not recommended for production) insecure_skip_verify = true ## The target database for metrics. database = \u0026#34;ntpserver\u0026#34; retention_policy = \u0026#34;\u0026#34; write_consistency = \u0026#34;any\u0026#34; timeout = \u0026#34;5s\u0026#34; ## Uncomment and set credentials if authentication is required. username = \u0026#34;ntp\u0026#34; password = \u0026#34;022510\u0026#34; ## Plugin for Chrony time synchronization data [[inputs.chrony]] server = \u0026#34;udp://localhost:323\u0026#34; timeout = \u0026#34;5s\u0026#34; metrics = [\u0026#34;tracking\u0026#34;, \u0026#34;activity\u0026#34;, \u0026#34;serverstats\u0026#34;, \u0026#34;sources\u0026#34;, \u0026#34;sourcestats\u0026#34;] socket_group = \u0026#34;chrony\u0026#34; socket_perms = \u0026#34;0660\u0026#34; ## CPU metrics: monitors CPU usage across cores and total CPU usage. [[inputs.cpu]] percpu = true totalcpu = true fielddrop = [\u0026#34;time_*\u0026#34;] ## Memory metrics: tracks usage, free memory, and swap. [[inputs.mem]] ## Disk metrics: monitors disk usage; ignore temporary filesystems. [[inputs.disk]] ignore_fs = [\u0026#34;tmpfs\u0026#34;, \u0026#34;devtmpfs\u0026#34;] ## Disk I/O metrics: measures read/write activity. [[inputs.diskio]] ## Network metrics: captures network interface statistics. [[inputs.net]] ## System metrics: collects system-level stats such as uptime and load. [[inputs.system]] ## Optional: Raspberry Pi specific temperature metric. [[inputs.exec]] commands = [\u0026#34;vcgencmd measure_temp\u0026#34;] name_override = \u0026#34;rpi_temp\u0026#34; interval = \u0026#34;10s\u0026#34; timeout = \u0026#34;5s\u0026#34; data_format = \u0026#34;value\u0026#34; data_type = \u0026#34;float\u0026#34; 9. Testing and Verification After rebooting your Pi to apply all changes, verify that everything is working correctly.\n9.1. Check Chrony Status Run the following command to check Chrony\u0026rsquo;s synchronization status:\nchronyc tracking A sample output might look like:\nReference ID : 50505300 (PPS) Stratum : 1 Ref time (UTC) : Sat Mar 29 05:35:12 2025 System time : 0.000000086 seconds fast of NTP time Last offset : +0.000000175 seconds RMS offset : 0.000000729 seconds Frequency : 1.945 ppm slow Residual freq : +0.000 ppm Skew : 0.012 ppm Root delay : 0.000000001 seconds Root dispersion : 0.000019379 seconds Update interval : 16.0 seconds Leap status : Normal This output indicates that Chrony is synchronizing correctly with your GPS/PPS source.\n9.2. Verify NTP Sources To view the status of the NTP sources, run:\nchronyc sources -v This command displays the current state of all NTP sources, including the GPS and PPS inputs along with fallback servers.\n10. Conclusion In this guide, you learned how to turn a Raspberry Pi 5 into a stratum‑1 NTP server by:\nInstalling essential packages like chrony, gpsd, telegraf, and others. Configuring the kernel and boot settings to enable GPS and PPS support. Setting up gpsd for interfacing with the GPS module. Configuring Chrony to use both GPS and PPS for time synchronization, with the additional benefit of PTP hardware timestamping. Using Telegraf to monitor system and synchronization metrics, sending data to an InfluxDB instance. By following these steps, you can build a highly accurate time server that not only ensures precise network synchronization but also offers detailed monitoring of its performance. Happy time syncing!\n","date":"2025-03-28T22:34:35-05:00","permalink":"https://johnburns.io/post/building-stratum-1-time-source/","section":"post","tags":null,"title":"Stratum‑1 NTP Server on Raspberry Pi 5"},{"categories":null,"contents":"Date: \u0026lt;2024-04-07 Sun\u0026gt;\nSubject: Understanding the Crystal Ball Function\nVersion: 1.0\nExploring the intricacies of the Crystal Ball Problem as it applies to arrays, this piece delves into the challenge of predicting future elements based on current sequences. It underscores the significance of pattern recognition and algorithmic forecasting in computational analysis and real-world applications.\nIntroduction to the Crystal Ball Problem with Arrays The Crystal Ball Problem in the context of arrays is a metaphorical representation of the challenge of predicting future elements or trends based on a current sequence of data. Imagine you have an array of numbers representing data points over time. The task is to predict the next set of values the array will hold using only the information currently available.\nThis problem encapsulates many real-world scenarios—from stock market predictions to weather forecasting—where accurately foreseeing future data points can lead to significant advantages. In computational terms, it often relates to the development of algorithms that efficiently analyze patterns within an array and extrapolate them to predict future outcomes.\nGiven an array ( A ) of length ( n ), with elements $$ A[1], A[2], \\dots, A[n] $$, the challenge is to predict $$ A[n+1], A[n+2], \\dots $$, assuming there are underlying patterns or rules governing the progression of the array\u0026rsquo;s elements. The \u0026ldquo;crystal ball\u0026rdquo; here symbolizes the hypothetical ability to see into the future of the array\u0026rsquo;s values.\nThe complexity of the Crystal Ball Problem can vary widely depending on the nature of the data and its inherent patterns. It might involve simple linear extrapolation, complex machine learning models, or even chaotic systems where accurate predictions are inherently difficult. The key lies in identifying and leveraging the mathematical or statistical relationships within the array to make informed predictions.\nWhy Square Root of ( n )? Optimization Balance The choice of ( m ) (the block size) as the square root of ( n ) comes from optimizing the sum of the number of steps taken to jump to the block containing the target element and the steps taken to perform a linear search within the block. Mathematically, when you differentiate the total steps function with respect to ( m ) and set it to zero to find the minimum, you end up with ( m ) being proportional to $$ \\sqrt{n} $$.\nTrade-off Between Jump and Search If the jump size is too large (e.g., using the cube root of ( n )), you minimize the number of jumps but potentially increase the length of the linear search within a block, leading to inefficiency. Conversely, smaller jumps (e.g., smaller than $$ \\sqrt{n} $$ ) reduce the linear search phase but increase the number of jumps, also leading to inefficiency.\nTheoretical Justification From a theoretical standpoint, using the square root of ( n ) ensures that the maximum number of jumps (to find the right block) and the maximum number of linear searches within a block are balanced, thus optimizing the search time.\nAlternative Roots Using a cube root or another root of ( n ) would skew the balance between the number of jumps and the linear search phase, potentially increasing the total search time. The square root of ( n ) optimally balances the algorithm, leading to a time complexity of $$ O(\\sqrt{n}), $$ which is better than linear search’s $$ O(n) $$ but not as efficient as binary search’s $$ O(\\log n) $$ for sorted arrays.\nThis explanation assumes a uniform distribution of search keys and does not take into account specific characteristics of the data, which might slightly affect the optimal block size in practice. However, for general purposes, the square root of ( n ) is a mathematically justified and practically effective choice.\nMathematical Justification Setting Up the Problem Jump Search involves jumping through an ordered list in increments of ( m ) (the jump size) and then performing a linear search within a block of size ( m ) once you\u0026rsquo;ve jumped past the target element. The objective is to minimize the total search time, which is a function of ( m ).\nMaximum number of jumps: $$ \\frac{n}{m} $$ Maximum number of steps in a linear search within a block: ( m - 1 ) (since after jumping, we might need to check up to ( m ) elements) Total Search Steps The total number of steps in the worst-case scenario can be approximated as the sum of the jumps and the linear search steps. We add 1 to the jump term to account for the final block where the linear search is performed: $$ T(m) = \\frac{n}{m} + (m - 1) + 1. $$ Simplifying, we obtain: $$ T(m) = \\frac{n}{m} + m. $$\nFinding the Optimal ( m ) To minimize ( T(m) ), we take the derivative of ( T(m) ) with respect to ( m ) and set it to zero: $$ \\frac{d}{dm}T(m) = -\\frac{n}{m^2} + 1 = 0. $$ Solving for ( m ): $$ m^2 = n, $$ which implies $$ m = \\sqrt{n}. $$\nExample with ( n = 100 ) Substituting ( n = 100 ): $$ m = \\sqrt{100} = 10. $$\nExplanation Jump Size: The optimal jump size is 10 for an array of 100 elements. This means we jump every 10 elements (i.e., 0, 10, 20, …, 90), ensuring that we make at most 10 jumps. Linear Search: Once we\u0026rsquo;ve jumped past the target element, we perform a linear search in a block of up to 10 elements, which, in the worst case, requires checking 9 additional elements. This method strikes a balance between the number of jumps and the size of the linear search, minimizing the total steps required in the worst case.\nConclusion The choice of the square root of ( n ) optimizes the Jump Search by equally balancing the potential number of jumps with the maximum size of the linear search. For an array of 100 elements, this theoretical justification shows why jumping in steps of 10 is optimal. This balance ensures that the algorithm achieves its best possible efficiency, with a time complexity of $$ O(\\sqrt{n}), $$ where ( n ) is the length of the array.\n","date":"2024-04-05T21:13:00-04:00","permalink":"https://johnburns.io/post/understanding-the-crystal-ball-function/","section":"post","tags":null,"title":"Understanding the Crystal Ball Function"},{"categories":null,"contents":"Version: 1.2\nStore all DotFiles in a bare git repository\nSetup git init \u0026ndash;bare $HOME/.cfg alias config=\u0026rsquo;usr/bin/git \u0026ndash;git-dir=$HOME.cfg/ \u0026ndash;work-tree=$HOME' echo \u0026ldquo;alias config=\u0026rsquo;usr/local/bin/git \u0026ndash;git-dir=$HOME.cfg/ \u0026ndash;work-tree=$HOME\u0026rsquo;\u0026rdquo; \u0026gt;\u0026gt; $HOME/.zsh/aliases config config \u0026ndash;local status.showUntrackedFiles no Adding files Manually add files to repository by using config add \u0026lt;filename\u0026gt;. Use this to add all your files manually, this way only updates to your tracked files will show\nAdd the github repository config remote add origin \u0026lt;remote-url\u0026gt; config push -u origin main Restore files from github echo \u0026ldquo;.cfg\u0026rdquo; \u0026gt;\u0026gt; .gitignore git clone \u0026lt;remote-git-repo-url\u0026gt; $HOME/.cfg alias config=\u0026rsquo;/usr/local/bin/git \u0026ndash;git-dir=\u0026lt;path to .cfg’s Git directory\u0026gt; \u0026ndash;work-tree=$HOME' config config \u0026ndash;local status.showUntrackedFiles no config checkout ","date":"2024-04-04T21:14:30-04:00","permalink":"https://johnburns.io/post/store-dotfile-with-git/","section":"post","tags":null,"title":"Store dotfile with git"},{"categories":null,"contents":"Date: \u0026lt;2024-04-03 Wed\u0026gt;\nTransforming Enterprise Networking: In the ever-evolving realm of enterprise networking, the integration of Artificial Intelligence (AI) technologies has become a game-changer. One of the most notable advancements in this area is Juniper Mist, a platform that leverages AI to revolutionize how networks are managed and operated. This article delves into how AI, particularly through solutions like Juniper Mist, is reshaping the enterprise networking landscape.\nUnderstanding Juniper Mist and Its AI-Driven Approach Juniper Mist is an AI-driven network solution that offers a unique combination of cloud management, advanced AI capabilities, and programmable APIs to deliver a full-stack solution for wireless, wired, and WAN networks. The platform is designed to simplify operations, improve user experiences, and provide unprecedented insight into network performance.\nKey Features of Juniper Mist: AI-Driven Insights: Uses machine learning to provide predictive recommendations and proactive corrections. Automated Operations: Simplifies network operations with automation, reducing manual tasks and errors. Enhanced User Experience: Offers personalized location services and ensures optimal network performance. Enhanced Network Reliability and Performance Juniper Mist uses AI to analyze network patterns and automatically optimize performance. This ensures higher reliability and better user experiences, as the network can dynamically adjust to changing conditions.\nProactive Issue Resolution With its AI-driven insights, Juniper Mist can identify and resolve issues before they impact users. This proactive approach to network management is a significant shift from the traditional reactive models.\nSimplified Network Management AI automation in Juniper Mist simplifies complex network management tasks. This ease of management is crucial for enterprises as networks become more complex with the addition of IoT devices and diverse user requirements.\nImproved Security Posture Juniper Mist enhances network security by using AI to detect anomalies and potential threats. This AI-driven approach allows for quicker response times and more effective mitigation strategies.\nReal-World Applications and Success Stories Enterprises across various sectors are leveraging Juniper Mist to transform their networking approach. For example, retail businesses use it to enhance in-store customer experiences through personalized engagement and reliable connectivity. In education, institutions utilize it for seamless online learning experiences.\nThe Future of Enterprise Networking with AI The integration of AI in enterprise networking, exemplified by Juniper Mist, is just the beginning. As AI technologies continue to evolve, we can expect even more innovative solutions that further streamline network management, enhance security, and improve user experiences.\nConclusion The advent of AI technologies like Juniper Mist is a milestone in the journey of enterprise networking. It represents a shift towards more intelligent, efficient, and user-centric network environments. As enterprises continue to adopt these advanced technologies, the landscape of enterprise networking will keep evolving, paving the way for smarter, more resilient networks.\n","date":"2024-04-03T21:22:42-04:00","permalink":"https://johnburns.io/post/transforming-enterprise-networking-the-impact-of-ai-technologies/","section":"post","tags":null,"title":"Transforming Enterprise Networking: The Impact of AI Technologies"},{"categories":null,"contents":"Date: \u0026lt;2024-01-28 Sun\u0026gt;\nVersion: 1.0\nWelcome to 2024, a year that continues to witness revolutionary changes in the world of networking. As a network engineer, I\u0026rsquo;ve seen firsthand the rapid evolution of technology in our field. This year is no exception, with several trends emerging that are reshaping how we think about and implement network infrastructure. Let\u0026rsquo;s dive into some of the top trends in networking for 2024.\n1. The Rise of 6G Technology Although 5G has just recently become mainstream, the buzz around 6G technology is already gaining momentum. Expected to be commercially available by 2030, research and development in 6G are heating up in 2024. This next-generation technology promises even faster speeds, lower latency, and higher reliability, paving the way for more advanced applications like holographic communications and augmented reality.\n2. Pervasive AI in Network Management Artificial Intelligence (AI) is no longer just a buzzword in network management. This year, we are seeing AI being integrally woven into the fabric of network operations. AI-driven analytics are being used for predictive maintenance, optimizing network performance, and enhancing security protocols. This trend is reducing downtime, improving efficiency, and proactively addressing potential threats before they become serious issues.\n3. Quantum Networking Quantum networking, although in its nascent stages, is showing promising advancements in 2024. With the potential to provide unbreakable encryption, it could revolutionize network security. This year, we\u0026rsquo;re witnessing increased investment and research in developing quantum networks, signaling a future where data transmission could be exponentially more secure.\n4. Edge Computing Gaining Traction Edge computing is taking a front seat in 2024, driven by the need for real-time data processing and reduced latency in IoT (Internet of Things) devices. By processing data closer to where it is generated, edge computing is enhancing the performance of IoT applications, especially in industries like manufacturing, healthcare, and smart cities.\n5. Sustainable Networking As environmental concerns continue to grow, sustainable networking is becoming a top priority. In 2024, we\u0026rsquo;re seeing a push towards more energy-efficient network infrastructure, with companies investing in green data centers and adopting technologies like software-defined networking (SDN) to reduce energy consumption.\n6. Wi-Fi 7 Emergence Wi-Fi 7 is emerging as a game-changer in 2024, promising higher data rates, increased capacity, and better performance in crowded networks. This latest iteration of Wi-Fi is set to improve wireless experiences significantly, catering to the growing demand for bandwidth-intensive applications like VR and 4K/8K video streaming.\n7. Expanded Use of SD-WAN Software-Defined Wide Area Networking (SD-WAN) continues to grow in popularity, offering more flexibility, improved performance, and enhanced security for distributed networks. In 2024, we\u0026rsquo;re seeing an increased adoption of SD-WAN by enterprises looking to streamline their network management and accommodate remote work models.\n8. Increased Focus on Network Security With the rise in cyber threats, network security remains a top concern in 2024. The focus is on developing more sophisticated security frameworks, incorporating AI and machine learning for real-time threat detection, and adopting zero trust models to ensure robust security in network access and data protection.\nConclusion The landscape of networking in 2024 is dynamic and exciting. From the advent of 6G to the integration of AI in network management, these trends are not just reshaping our networks but also the way we interact with technology in our everyday lives. As a network engineer, staying abreast of these trends is crucial for navigating the future of networking, ensuring we are ready for the challenges and opportunities that lie ahead.\n","date":"2024-03-05T01:02:52-04:00","permalink":"https://johnburns.io/post/top-networking-trends-of-2024-a-network-engineer-s-perspective/","section":"post","tags":null,"title":"Top Networking Trends of 2024: A Network Engineer's Perspective"},{"categories":["emacs"],"contents":"GnuPG Cheatsheet Quick list of the most common GnuPG commands that I need most often. Encrypt, decrypt, signing, key management, key servers, and special features.\nEncrypt and decrypt Encrypt a file with your key gpg -er me@example.org diary.txt Options\n-r encrypts the file for the user specified as argument. The output is written to diary.txt.gpg.\nEncrypt a file for another person gpg -er alice@example.org diary.txt Encrypt a file with passphrase gpg -c diary.txt Decrypt a file gpg -do diary.txt diary.txt.gpg Encrypt and sign Encrypt a file and sign with your key gpg -esr alice@example.orge diary.txt Sign and encrypt the file, output is written to diary.txt.gpg.\nDecrypt and verify a file gpg -do diary.txt diary.txt.gpg Signing and verification Signing compresses the file and append a signature. Signing Sign a file gpg -s diary.txt The signature is written to diary.txt.gpg.\nVerify a signature gpg --verify diary.txt.gpg Verify a signature and restore the file gpg -do diary.txt diary.txt.gpg -d is for decryption, this works for signature files as well.\nSpecial forms of signing With clearsign, the output is wrapped in an ASCII-armored signature.\nClearsign a file\ngpg --clearsign diary.txt The signature is written to diary.txt.asc.\nVerify a clearsign signature\ngpg --verify diary.txt.asc Verify a signature and restore the file\ngpg -do diary.txt diary.txt.asc -d is for decryption, this works for signature files as well.\nDetached signatures are just signatures without any data\nsign a file using detached signature\ngpg -o diary.txt.sig --detach-sig diary.txt Verify a detached signature\ngpg --verify diary.txt.sig diary.txt Public key management List all public keys in keyring gpg -k Export a public key gpg -ao alice\\_pub.asc --export alice@example.org Import a public key gpg --import alice\\_pub.asc Verify a public key fingerprint gpg --fingerprint alice@example.org Secret key management Generate key pair (RSA,DSA, ECC like Curve 25519) gpg --expert --full-gen-key Using expert mode for key generation enables the choice of different key types.\nEdit secret key gpg --expert --edit-key me@example.org Most interesting commands: adduid Create an additional user ID revuid Revoke a user ID or photographic user ID primary Flag the current user id as the primary one addkey Add a subkey to this key expire Change the key or subkey expiration time passwd Change the passphrase of the secret key save Save all changes to the keyrings and quit List all secret keys gpg -K Generate revocation certificate gpg -ao revoke-key.asc --gen-revoke A767285029E8882A Deleting keys gpg --delete-secret-key A767285029E8882A gpg --delete-key A767285029E8882A Make sure you have published a revocation certificate, if your key was uploaded to a key server!\nSigning parties Show the public key fingerprint gpg --fingerprint 00AA11BB22CC33DD Sign a public key gpg --sign-key 00AA11BB22CC33DD List keys with signatures gpg --list-sigs Generate fingerprint paper slips gpg-key2latex --show-qrcode 00AA11BB22CC33DD Key servers Send public key to a keyserver gpg --keyserver hkp://pgp.mit.edu --send-keys A767285029E8882A Remember it\u0026rsquo;s not possible to remove a key from any keyserver!\nGet public key from a keyserver gpg --keyserver hkp://pgp.mit.edu --recv-key A767285029E8882A Search public key on a keyserver gpg --keyserver hkp://pgp.mit.edu --search-keys Alice Refresh all keys from keyserver gpg --keyserver hkp://pgp.mit.edu --refresh-keys Useful for updating a key with the latest signatures, user IDs, etc. Calling this with no arguments will refresh the entire keyring.\nFancy features Export SSH compatible public key gpg --export-ssh-key me@example.org Export a key in the OpenSSH public key format. You need a subkey for authentication purposes [A].\nGet keygrip gpg --list-secret-keys --with-keygrip The keygrip can be put in ~/.gnupg/sshcontrol to use GnuPG for ssh authentication.\nExport subkeys gpg -o my\\_subkey.gpg --export-secret-subkey F988A393A99DB2F3! Export only one or more subkeys for a stripped keyring. Remember the required ! at the end.\nUpdate trust db gpg --update-trustdb ","date":"2022-08-21T00:00:00Z","permalink":"https://johnburns.io/post/gnupg-cheat-sheet/","section":"post","tags":["hugo","org"],"title":"GnuPG Cheat Sheet"},{"categories":null,"contents":"Develop and Deploy Network Templates Before Automating Date: 2022-05-26\nSubject: Network Templating\nVersion 1.0\nAutomation is the number one topic in networking today. Automation allows a team to lean left, moving simple troubleshooting to the NOC, it allows the team to do more with less, and it allows for repeatable deployments. A good place to start is to think about many of the day to day work that gets done, how much of this work is simply applying the same changes over and over. These tasks are a great place to start with templating.\nI think an obvious task to start for automation is VPN deployments. This is a task that involved touching at least 2 routers and possibly 4 routers if redundant VPN\u0026rsquo;s are the standard for your company. This usually also involves configuring an IGP or BGP instance or both on each router, as well as modifying multiple Access lists. It is also a task where small inconsistencies can lead to hours of troubleshooting.\nH H e e a a H d R d R Q 1 2 E E n n d d T o p o l o g y r e m R o e R t m R e e o 1 m R t o 2 S e t i e t e What\u0026rsquo;s Needed Python 3.x Jinja support Yaml support Yaml Answer File Jinja Template for each router python script to render First we need to create a template for each router. I am only providing a single template here instead of four. Although this is a working correct template, configuring VPN\u0026rsquo;s is beyond the scope of this tutorial. Anyone with a few years of experience should be able to build the missing files in a lab based on whats provided. cisco.j2 !Configure GRE interface {{ loopback_interface }} ip address {{ loopback_address }} interface {{ tunnel_interface}} no shutdown ip address 10.10.100.1 255.255.255.0 tunnel source {{loopback_interface }} tunnel destination {{ tunnel_destination }} tunnel path-mtu-discovery tunnel protection ipsec profile ikev2_TP exit !Configure Ike Policy crypto ikev2 keyring {{ ike_keyring_name }} peer {{ ike_keyring_peer }} address {{ ike_keyring_address }} pre-shared-key {{ ike_keyring_preshared_key }} crypto ikev2 proposal {{proposal_name }} encryption {{ proposal_encryption }} integrity {{ proposal_integrity }} group {{ proposal_group }} crypto ikev2 profile {{ profile_name }} match identity remote address {{ profile_remote_address }} authentication local {{ profile_authentication_local }} authentication remote {{ profile_authentication_remote }} keyring local {{ profile_keyring_local }} crypto ikev2 policy {{ crypto_policy_name }} proposal {{ crypto_policy_proposal }} ip access-list extended {{ crypto_match_acl_name }} permit ip host {{ crypto_match_acl_local }} host {{ crypto_match_acl_remote }} permit ip host {{crypto_match_acl_remote }} host {{ crypto_match_acl_local }} crypto ipsec transform-set {{ transformset_data }} ! Define Crypto map and Ipsec crypto map {{ cryptomap_name }} ipsec-isakmp set peer {{ cryptomap_peer }} set security-association lifetime seconds 3600 set transform-set {{ cryptomap_tset }} set pfs {{ cryptomap_group }} set ikev2-profile {{ cryptomap_profile }} match address {{ cryptomap_match }} interface {{ interface_name }} ip address 1.1.1.1 255.255.255.224 negotiation auto {{ interface_crypto }} Yaml Answer file --- loopback_interface: Loopback0 loopback_address: \u0026#34;10.1.1.1 255.255.255.0\u0026#34; tunnel_interface: Tunnel100 tunnel_destination: 10.2.2.2 ike_keyring_name: HQ ike_keyring_peer: HQ ike_keyring_address: 2.2.2.2 ike_keyring_preshared_key: cisco1234 proposal_name: Prop-HQ proposal_encryption: aes-cbc-256 proposal_integrity: sha256 proposal_group: 19 profile_name: PROFILE-HQ profile_remote_address: \u0026#34;2.2.2.2 255.255.255.255\u0026#34; profile_authentication_local: pre-share profile_authentication_remote: pre-share profile_keyring_local: HQ crypto_policy_name: POL-HQ crypto_policy_proposal: Prop-HQ crypto_match_acl_name: VPNACL-HQ crypto_match_acl_local: 10.2.2.2 crypto_match_acl_remote: 10.1.1.1 transformset_data: \u0026#34;TS-HQ esp-aes 256 esp-sha256-hmac\u0026#34; cryptomap_name: \u0026#34;CMAP-HQ 10\u0026#34; cryptomap_peer: 2.2.2.2 cryptomap_tset: TS-HQ cryptomap_pfs: group19 cryptomap_profile: PROFILE-HQ cryptomap_match: VPNACL-HQ interface_name: GigabitEthernet0/0/0 interface_crypto: \u0026#34;crypto map CMAP-HQ\u0026#34; script.py #Imports import yaml from jinja2 import Environment, FileSystemLoader # Load yaml template into memory config = yaml.load(open(\u0026#39;./answer.yaml\u0026#39;,\u0026#39;r\u0026#39;), Loader=yaml.FullLoader) # Load jinja template into memory env = Environment(loader = FileSystemLoader(\u0026#39;./\u0026#39;), trim_blocks=True, lstrip_blocks=True) template = env.get_template(\u0026#39;cisco.j2\u0026#39;) # Render template to file with open(\u0026#34;cisco-out.txt\u0026#34;,\u0026#39;w\u0026#39;) as f: f.write(template.render(config)) Output !Configure GRE interface Loopback0 ip address 10.1.1.1 255.255.255.0 interface Tunnel100 no shutdown ip address 10.10.100.1 255.255.255.0 tunnel source Loopback0 tunnel destination 10.2.2.2 tunnel path-mtu-discovery tunnel protection ipsec profile ikev2_TP exit !Configure Ike Policy crypto ikev2 keyring HQ peer HQ address 2.2.2.2 pre-shared-key cisco1234 crypto ikev2 proposal Prop-HQ encryption aes-cbc-256 integrity sha256 group 19 crypto ikev2 profile PROFILE-HQ match identity remote address 2.2.2.2 255.255.255.255 authentication local pre-share authentication remote pre-share keyring local HQ crypto ikev2 policy POL-HQ proposal Prop-HQ ip access-list extended VPNACL-HQ permit ip host 10.2.2.2 host 10.1.1.1 permit ip host 10.1.1.1 host 10.2.2.2 crypto ipsec transform-set TS-HQ esp-aes 256 esp-sha256-hmac ! Define Crypto map and Ipsec crypto map CMAP-HQ 10 ipsec-isakmp set peer 2.2.2.2 set security-association lifetime seconds 3600 set transform-set TS-HQ set pfs set ikev2-profile PROFILE-HQ match address VPNACL-HQ interface GigabitEthernet0/0/0 ip address 1.1.1.1 255.255.255.224 negotiation auto crypto map CMAP-HQ ","date":"2022-05-26T13:00:00Z","permalink":"https://johnburns.io/post/beginner-network-templating/","section":"post","tags":null,"title":"beginner-network-templating"},{"categories":null,"contents":"Rename accounts in FreeBSD pw usermod -n oldname -l newname -d /usr/home/newname\npw groupmod -n oldname -l newname\nmv /usr/home/oldname /usr/home/newname\nchown -R newname:newname /usr/home/newname\n","date":"2018-03-14T13:53:12Z","permalink":"https://johnburns.io/post/rename-accounts-in-freebsd/","section":"post","tags":null,"title":"rename-accounts-in-freebsd"},{"categories":null,"contents":"Bhyve on FreeBSD 10.1 I recently started a new series of videos on YouTube about my favorite operating system FreeBSD. Below are the commands used in the video to setup the bhyve hypervisor on FreeBSD 10.1 with a virtualized Ubuntu 15 server.\n######## prerequisites for bhyve on FreeBSD ########## pkg install grub2-bhyve mkdir /virtual_machines cd /virtual_machines mkdir iso cd iso fetch http://releases.ubuntu.com/15.04/ubuntu-15.04-server-amd64.iso ######��� Load kernel modules and set sysctl values ###### kldload if_tap kldload if_bridge kldload vmm kldload nmdm ###### set sysctl values� #######3 sysctl net.link.tap.up_on_open=1 sysctl net.inet.ip.forwarding=1 echo \u0026#34;net.link.tap.up_on_open=1\u0026#34; \u0026amp;gt;\u0026amp;gt; /etc/sysctl.conf echo \u0026#34;vm1:dv=/dev/nmdm1B:br#9600:pa=none:\u0026#34; \u0026amp;gt;\u0026amp;gt; /etc/remote ##### create interfaces needed for the vm� ######## ifconfig tap1 create ifconfig bridge0 create ifconfig bridge0 addm tap1 addm em0 up ##### create the config files and virtual disk� ######## truncate -s 10g vm1.img vi device.map (hd0) /virtual_machines/ubuntu_server/vm1.img (cd0) /virtual_machines/iso/ubuntu15server.iso ####### Boot the virtual machines ########### grub-bhyve -r cd0 -m /virtual_machines/ubuntu_server/device.map -M 1024 vm1 bhyve -c 1 -m 1024M -H -P -A \\ -l com1,/dev/nmdm0A \\ -s 0:0,hostbridge \\ -s 1:0,lpc -s 2:0,virtio-net,tap1 \\ -s 3,ahci-cd,/virtual_machines/iso/ubuntu15server.iso \\ -s 4,virtio-blk,/virtual_machines/ubuntu_server/vm1.img vm1 \u0026amp;amp; ########### boot into newly installed vm ################333\nrub-bhyve -r hd0,msdos1 -m /virtual_machines/ubuntu_server/device.map -M 1024 vm1 bhyve -c 1 -m 1024M -H -P -A \\ -l com1,/dev/nmdm0A \\ -s 0:0,hostbridge \\ -s 1:0,lpc -s 2:0,virtio-net,tap1 \\ -s 4,virtio-blk,/virtual_machines/ubuntu_server/vm1.img vm1 \u0026amp;amp; #################3 bhyve commands and nice to haves ##########\nkill running bhyve machines bhyvectl --destroy --vm=name_of_vm create bridge and tap interfaces to provision at system boot\n","date":"2015-05-15T00:43:24Z","permalink":"https://johnburns.io/post/bhyve-on-freebsd-10-1/","section":"post","tags":null,"title":"bhyve-on-freebsd-10-1"},{"categories":null,"contents":"poem So live your life that the fear of death can never enter your heart. Trouble no one about their religion Respect others in their view And demand that they respect yours Love your life, perfect your life, beautify all things in your life Seek to make your life long and its purpose in the service of your people Prepare a noble death song for the day when you go over the great divide Always give a word or a sign of salute when meeting or passing a friend Even a stranger when in a lonely place Show respect to all people and grovel to none When you arise in the morning give thanks for the food and for the joy of living If you see no reason for giving thanks, the fault lies only in yourself Abuse no one and nothing For abuse turns the wise ones to fools and robs the spirit of its vision When it comes your time to die Be not like those whose hearts are filled with the fear of death So that when their time comes They weep and pray for a little more time To live their lives over again in a different way Sing your death song And die like a hero going home\n","date":"2013-10-20T18:10:50Z","permalink":"https://johnburns.io/post/poem/","section":"post","tags":null,"title":"poem"},{"categories":null,"contents":"Slow Downloads in Itunes If you are experiencing slow downloads in iTunes try this:\nShut down iTunes\nDisable antivirus/internet security suite\nOpen itunes and resume downloads.\nThis is most often caused by the internet security suite which is not capable of scanning large files in real time. If this fixes your problem, you can usually make the fix permanent by disabling the piece of the antivirus that filters web traffic.\n","date":"2012-11-11T19:34:15Z","permalink":"https://johnburns.io/post/slow-downloads-in-itunes/","section":"post","tags":null,"title":"slow-downloads-in-itunes"},{"categories":null,"contents":"New route-server available! I have been working on a new project which is to provide a service that would allow you to peer with my router over BGP. My router would then advertise a list of bogons and known malicious networks including botnet command and control networks. You can then drop these networks at your border router thus protecting your network from attacks and saving precious router and firewall resources. Right now I am not offering the peering service but I do have a route-view server available that allows you to login and get a full list of the malicious ip networks for ipv6 and ipv4. To access the router please ssh to rviews.techinvasion.net. If you have ipv6 access there is a AAAA record as well, allowing you to access the router on both ipv4 and ipv6.\n","date":"2010-09-03T21:02:43Z","permalink":"https://johnburns.io/post/new-route-server-available/","section":"post","tags":null,"title":"new-route-server-available"},{"categories":null,"contents":"New mailing List I started a new mailing list. this list is for anyone to ask questions about networking design and implimentation. We can help with configuration questions of all gear Juniper, cisco, hp, fortinet\u0026hellip;..\nAlso questions reguarding Linux, Solaris �and BSD are welcome as well\nhttp://lists.techinvasion.net\n","date":"2010-07-13T10:44:15Z","permalink":"https://johnburns.io/post/new-mailing-list/","section":"post","tags":null,"title":"new-mailing-list"},{"categories":null,"contents":"Found This Funny Banner Today! ","date":"2010-06-28T18:05:35Z","permalink":"https://johnburns.io/post/found-this-funny-banner-today/","section":"post","tags":null,"title":"found-this-funny-banner-today"},{"categories":null,"contents":"MPLS VPN Services This article with aim to take a in depth look at MPLS and explain how your packets get from one side of the MPLS cloud to another. Hopefully this will give you some perspective that will prove useful in troubleshooting issues in your own MPLS implementations.\nMost enterprise engineers MPLS experience goes something like this: The company needs to connect the office in Miami and the office in London with the corporate headquarters office in Chicago. The VPN design needs to be flexible, and most importantly the network connecting all 3 sites needs to be full mesh. By this I mean to say that any office should be able to talk to any other office using this MPLS VPN. At this point you contact your MPLS provider and ask them to provision 3 MPLS links, 1 for each of the above mentioned offices. The MPLS Sales team puts you in contact with their engineering department and they ask you a couple questions that they need answered in order to properly provision your lines. the number one question that they ask is \u0026ldquo;How do you want to send us routes?\u0026rdquo; �now depending on the size of your organization and the dynamic or static nature of your network you can opt for several options here are 3 of the most common.\nStatic Routes\nBGP Peering\nOSPF Peering\nNow if your network is very small, say for instance you have 3 shoe stores that need to talk to the corporate office / warehouse, then you might opt for the static route option. If you are a large organization that is publicly traded and has a robust network and security policy in place you will most likely choose the second option as this gives you the most security and control over what routes enter and leave your network. �However the third option is also very popular, mainly because many organizations are already running OSPF, so this makes it that much easier to peer with the ISP. However using the same IGP to peer with your MPLS provider as you use to run your internal networks does leave you at risk. There are a host of vulnerabilities OSPF has that could be exploited even if you are using OSPF MD5 authentication such as LSA injection attacks. However the biggest reason not to do this is that if the ISP makes a mistake they could inadvertently dump hundred or thousands of routes into your routing table which could destabilize your entire network.\nNow wouldn\u0026rsquo;t you know after all that negative talk about ospf peering. The example I am going to talk about below is exactly that OSPF peering.\nPlease click on the above diagram for a larger view, you may want to download it as well and open it in a image view to zoom in on some of the smaller text and details.\nIn the example above you have 2 companies. To keep things simple we will call them Company A and Company B. Company A has 2 sites that need to communicate using MPLS, Company B also has 2 sites that need to communicate using MPLS. This ISP is lucky enough to get the business for both Company A and Company B. The ISP has a core network made up of an unspecified number of routers. In this example we will look at a small portion of the companies network. Our little piece of the network shows both customer sites connected to PE routers or (Provider edge) routers. These routers are responsible for providing access to the customers. The core of the network is made of P routers, or Provider routers. This provider has decided to convert their entire network to MPLS. This gives the ISP better performance by allowing the routers to utilize the ASICS built into the routers to switch the packets at incredible speeds. It also allows the ISP to offer many new services such as MPLS VPN\u0026rsquo;s as well as VPLS or (Virtual Private Lan Service.) In addition to these services the ISP can Use the tunneling aspect of MPLS to create Traffic engineering tunnels that will allow it to very precisely control which paths through the Provider network certain traffic takes. It also allows them to set very specific and granular QOS or COS policies for customers.\nMPLS confuses many people because of its amorphous place in the OSI model. MPLs officially is a layer 2.5 protocol because Layer 3 protocols can be encapsulated in MPLS. MPLS stand for Multi Protocol Label Switching. MPLS can carry many different Layer 3 protocols inside it, just as ethernet a layer 2 protocol can carry TCP/IP inside its frames. However MPLS is more complicated than that. Many people can easily be confused because MPLs depends on the routing table in order to function, in this sense you could think of it like a layer 4 protocol. MPLS cannot function if the routing table is not working. MPLS depends on LDP or the Label Distribution Protocol to form adjacencies with neighbors and distribute its list of labels as well as receive labels from peers. LDP forms adjacencies at the layer 3 level and used the routing table to find peers. LDP is similar to OSPF in that is uses the highest Loopback address to identify itself. In our network Diagram each switch has a loopback address. All of the P routers including the PE routers are running OSPF. This OSPF instance is advertising the subnets owned by the ISP, many ISP\u0026rsquo;s use ISIS for this purpose, in fact many ISP\u0026rsquo;s use private addresses in their network especially if there network is a transit network. There are many situation in which you have public IP traffic traversing a private network connecting another public network. The 3 P routers and 2 PE routers need to know how to get to all of the non public IP addresses that the ISP is using to connect their network together. OSPF is used to synchronize these addresses as well as advertise each routers loopback address. Once all routers have formed neighbor relationships and all routes have been distributed through OSPF LDP is able to use the routing table to form adjacencies with other routers using their loopback addresses.\nOnce LDP has formed neighbor relationships with other routers using their loopback addresses it is able to start synchronizing the tag database. MPLS Assigns a tag or label to every route in the routing table. when a packet enters the MPLS PE routers interface, the router does a route lookup to determine the tag for the destination of the packet. Once this decision had been made, the router will push the tag on the packet and send it out the appropriate interface. The next router in line �has a simpler job. This router does not even have to look at the routing table, it can just look at its forwarding table and see what new tag should be assigned to the packet and send the packet on its way. the reason why this is so fast is because the MPLS tags were designed to look like layer 2 frames to the ASICS on the routers. This allows the programmers to leverage the same high speed chips used to route packets from one switch port to another based on mac addresses.\nIn MPLS the language is push and pop. to push a tag is to add a tag to a packet and to pop is to remove a tag from a packet.\nOnce MPLS is working the ISP can begin to configure its client connections. To do this the ISP creates two VRF tables (Virtual Routing forwarding). The first VRF table we will call CompanyA and the second VRF table we will call CompanyB. It is important to add 2 things to each VRF table. The first thing is the route-target and the second is the route-discriminator. The route target is used by BGP as an extended community attribute. This lets BGP and other protocols determine what routes should be added to a VRF instance, and it also lets BGP know what routes are from a VRF instance.\nThis is important, because we need a way to get the routes from Company A site 1 into Company A site 2 router without mixing them up with routes from any other client. This is one of the key factors that lets two way route redistribution function correctly.\nOnce the VRF is created the next thing to do is go to the interface that connects the customer and add that interface to the Companies VRF. Once you do this the connected route for that interface should no longer show up on the main routing table. Once this step is complete it is time to configure a second instance of OSPF to communicate with the CPE equipment. this is done by specifying the VRF name when creating the new instance of OSPF.\nNow that the OSPF adjacency is up with the customer you should be able to see a list of the routes under that VRF. The next step is to establish a BGP neighbor relationship with the other PE routers in the ISP or a Route Reflector depending on the size of the environment. Once the BGP relationship is established, the only thing you have to do is redistribute the OSPF routes into BGP and vice versa under the appropriate OSPF Instance.\nThe end users should see the OSPF routes as simple IA routes. At the end of this post I will attach the full configs for all routers used incase you want to duplicate this in a lab or use GNS3 or Dynamips.\n[caption id=\u0026ldquo;attachment_218\u0026rdquo; align=\u0026ldquo;alignleft\u0026rdquo; width=\u0026ldquo;631\u0026rdquo; caption=\u0026ldquo;Routes as seen by end USER or MPLS Subscriber\u0026rdquo;][/caption]\nHere are links to all the configs for all routers used in the lab \u0026ndash;\u0026gt;Router Configs\n","date":"2010-02-09T21:04:40Z","permalink":"https://johnburns.io/post/mpls-vpn-services/","section":"post","tags":null,"title":"mpls-vpn-services"},{"categories":null,"contents":"SSH Brute Force Mitigation in Junos I have several Juniper SRX-210 devices configured in remote offices. One of the biggest problems I have is that there are a lot of people that are constantly running scripts against the ssh daemon. Now I could lock it down to only a specified list of allowed IP addresses. This would be the most secure method but i have a business requirement of being able to connect to this device from many different location. There is a command you can use to mitigate brute force attempts.\nThe command limits the number of ssh attempts per minute per source ip to 2. Just enough incase you make a mistake during login, but not enough for a script kiddie to run 500 attacks a minute against your firewall.\nservices {\rssh {\rrate-limit 2;\r}\r}\r","date":"2009-11-11T20:20:38Z","permalink":"https://johnburns.io/post/ssh-brute-force-mitigation-in-junos/","section":"post","tags":null,"title":"ssh-brute-force-mitigation-in-junos"},{"categories":null,"contents":"Public DMVPN network. I was thinking about a new project idea. I was thinking of setting up a dynamic multipoint VPN concentrator. Put a small LAN behind it with a couple of servers. Put the configuration instructions on a webpage for Juniper and Cisco devices. I was thinking to run BGP routing protocol over the interface as it scales reasonably well.\nThe important part here is I wanted to create a web form which requests the internal and external address ranges of anyones network. Once that person submits that information I will have a Peal script pull those messages from the web form, parse the information, insert the networks and IP addresses into a J-Script template and apply it to my Juniper SRX router automatically.\nThis project will enable Cisco and Juniper students to participate in the environment and create a public VPN network where p2p APPS and anything else can run over the network without having to worry about any prying eyes. I want to see how far this project will scale. I was even envisioning a time when other people with idle equipment can volunteer to become a secondary hub to take some of the load once my connection reaches 10 thousand or so tunnels. Because of the way DMVPN works. The tunnels between sites will open up as needed when a user from site A needs to talk to site B. This combined with using BGP as the routing protocol will mean that it will require very little bandwidth as traffic destined from site A to C will not transit site B if site B in this scenario is the hub.\nAnyways if anyone out there is interested please leave a comment.\n","date":"2009-10-03T22:10:04Z","permalink":"https://johnburns.io/post/public-dmvpn-network/","section":"post","tags":null,"title":"public-dmvpn-network"},{"categories":null,"contents":"Send me questions and feedback! I see a lot of you out there find this site through various search engines and many of you are searching for information on gre tunnels. I just wanted to say how much I appreciate the traffic and I want to let everyone know that creating an account is free and I would love to hear your feedback on articles and any questions you might have.\n","date":"2009-07-20T15:57:31Z","permalink":"https://johnburns.io/post/send-me-questions-and-feedback/","section":"post","tags":null,"title":"send-me-questions-and-feedback"},{"categories":null,"contents":"Using IP SLA with Route-maps I recently came across a problem that is not an uncommon problem that small businesses face. I came up with several solutions to their problems and I thought I would take a minute to discuss one of those solutions. This customer has a business requirement to use a proxy server for all outgoing web traffic. This on the face of it seems like a simple problem, there are many good proxy vendors out their such as my favorite vendor Blue Coat. There are many free alternatives such as Squid Caching Proxy server.\nNow this is where things get interesting, the office is still using novel e-directory, yes I know Novell is ancient but that is what they are using. The other interesting issue they have is that they went with a proxy server vendor that does not support WCCP. Enough with the limitations now lets talk requirements! The business requirements are as follows, using their existing IT resources and infrastructure they need a proxy solution that is simple to support and highly available, they also need a way of insuring all clients are using the proxy and they do not have the resources to run all over the network manually entering proxy setting or dealing with an overwhelming number of support calls related to incorrect proxy settings. Now that we are done with the limitations and requirements lets spend a little time talking about proxy solutions.\nThe most popular solution today is to use some sort of interception caching mechanism such as WCCP. Now WCCP is a Cisco protocol that has been more or less adopted by many other vendors even though the name is different foundry supports this protocol in their layer 4 switches, juniper supports it although under a different name, as well as HP switch and router products. The way WCCP works is to grab packets matching either an access-list or the built in web-cache group and forward those packets to the proxy, their by intercepting the packets as they reach the routed interface upstream from the end user. Now Cisco routers do this by creating a one-way GRE tunnel while Cisco switches perform this by using L2 redirects. If you are configuring WCCP on a Catalyst 6500 switch you have a choice of using L2 redirects or GRE tunnels.\nThe second most popular way to insure inform proxy setting across an enterprise is to use WPAD or (Web Proxy Auto Discovery Protocol) . Wpad works by writing a small JavaScript function in a text file, which tells the browser the proxy settings and what domains or subnets are excluded from the proxy such as local settings. Once you create your text file you save it to a web server on the local LAN in the root directory. An example would be http://webserver.mycompany.com/wpad.dat .\nAn example of the contents of the above file are as follows:\nfunction FindProxyForURL(url, host) { // our local URLs from the domains below example.com don\u0026#39;t need a proxy: if (shExpMatch(url,\u0026#34;*.techinvasion.local/*\u0026#34;)) {return \u0026#34;DIRECT\u0026#34;;} // URLs within this network are accessed through // port 8080 on fastproxy.example.com: if (isInNet(host, \u0026#34;10.0.0.0\u0026#34;, \u0026#34;255.255.255.0\u0026#34;)) { return \u0026#34;PROXY proxy.techinvasion.local:3128\u0026#34;; } // All other requests go through port 3128 of proxy.example.com. // should that fail to respond, go directly to the WWW: return \u0026#34;PROXY proxy.techinvasion.local:3128; DIRECT\u0026#34;; } The next step would be to add option 252 to the dhcp scope with an ASCII text entry of the web server path to the wpad.dat file as listed above. On a Cisco router with DHCP the entry would look like the following:\nip dhcp pool lan network 10.0.0.0 255.255.255.0 update dns both domain-name techinvasion.local default-router 10.0.0.254 dns-server 10.0.0.9 10.0.0.2 option 252 ascii \u0026#34;http://stats.techinvasion.local/proxy.pac\u0026#34; lease infinite ! After this is done you should be in business. The only problem with this approach is that if you do not have active directory to force enable automatic proxy detection in internet explorer you really have no way to force users to look for this pac file. This can create uniformity problems and generate more calls to the help desk.\nThe final way we can configure the proxy is to use route-maps to redirect all web traffic to the proxy. The only problem with this approach is that if for some reason the proxy Is to go down the route-map will be directing traffic to a black hole! To remedy this we can use the IP-SLA feature to monitor the proxy and deactivate the route-map if the proxy is unavailable. Now some things to remember, the route-map is only sending the traffic on port 80 to the proxy on port 80, if your proxy runs on a different port you will need to do a port redirect using ipfilter on FreeBSD based proxies, or ipchains on Linux based proxies to change the traffic to the correct port. Ok let get started with our configuration.\nStep one create a http monitor that will use your proxy to pull an outside site like yahoo.com.\nip sla monitor 1 type http operation get url http://www.yahoo.com name-server 10.0.0.9 proxy http://10.0.0.8/ timeout 5000 ! ip sla monitor schedule 1 start-time now The above code polls yahoo.com every 60 seconds to verify that the proxy server is working. Once you have that turned on you can issue the following commands to test it.\n#sh ip sla monitor statistics 1 Round trip time (RTT) Index 1 Latest RTT: 266 ms Latest operation start time: 04:19:13.020 edt Mon Jul 13 2009 Latest operation return code: OK Latest DNS RTT: 0 ms Latest TCP Connection RTT: 18 ms Latest HTTP Transaction RTT: 248 ms Number of successes: 55 Number of failures: 5 Operation time to live: 0 If you see: Last operation return code: OK Then that means everything is ok, it will say timeout if the proxy is down. Now I do the proxy test on port 80 because I want to verify that the ipchains port redirection rule is working as well, however you could specify a different port such as 3128 or 8080 if you wanted to.\nThe next step is to build the route-map and the track object. The track object is what the route map references to check availability of the next hop, in this case the next hop is the proxy. You setup as track object as follows.\nTrack option1 option2 option3 Option 1 (\u0026amp;lt;1-500 \u0026amp;gt; Tracked object) Option 2 (interface Select an interface to track) (ip IP protocol) (list Group objects in a list) (rtr Response Time Reporter (RTR) entry) Option 3 (\u0026amp;lt;1-2147483647\u0026amp;gt; Entry number) � this refers to the monitor number in the IP SLA command In our case we want a response time reporter because we are interested in up/down information about the proxy.\ntrack 1 rtr 1 Now we need to build and apply the route-map. First we need to build an access-list to specify the interesting traffic the route-map will be forwarding.\nip access-list extended proxy 10 deny ip host 10.0.0.8 any ! Block proxy traffic, we do not want to create a routing loop. 20 permit tcp 10.0.0.0 0.0.0.255 any eq 80 Here is the appropriate route-map below\nroute-map proxy permit 10 match ip address proxy set ip next-hop verify-availability 10.0.0.8 1 track 1 \u0026lt;/pre\u0026gt; To test this we can issue the command\n#show route-map proxy route-map proxy, permit, sequence 10 Match clauses: ip address (access-lists): proxy Set clauses: ip next-hop verify-availability 10.0.0.8 1 track 1 [up] Policy routing matches: 41673 packets, 6145267 bytes You will notice the �UP� this means that it sees our track object and it is getting th response time code from the ip sla monitor that we setup.\n","date":"2009-07-19T09:38:07Z","permalink":"https://johnburns.io/post/using-ip-sla-with-route-maps/","section":"post","tags":null,"title":"using-ip-sla-with-route-maps"},{"categories":null,"contents":"Introduction to Filter list for JUNOS Junipers JUNOS is a very robust operating system, not only is the OS very advanced but the ASIC heavy design of Juniper hardware is akin to calorie free chocolate bars! Juniper Filter Lists which are non-stateful packet filters similar to Cisco Access-Lists are compiled and processed using hardware, what this means is that you can have as many Filter-Lists as you want and as long as you want without degrading performance.\nJuniper is also big on naming things, in JUNOS everything has a name, the Filter Lists have names, the terms in the Filter Lists have names, and even the address\u0026rsquo;s you are matching on have names. This is a big concept in JUNOS because it allows you to write snippets of Filter-Lists and use them for many different Filter Lists. JUNOS also supports grouping Filter Lists and applying an entire group of filter to an interface. If you apply Filter groups to a JUNOS interface they individual Filter Lists are evaluated in order sequentially.\nTo facilitate out discussion of Filter-Lists let�s take a look at a standard anti-spoofing access list which would be applied to most edge routers. First let�s talk about what a vanilla anti-spoofing ACL should contain! A standard ACL at a minimum should block all RFC-1918 address space from the internet, it should also block undesirable types of ICMP traffic, and depending on the setup should block packets with illegal combinations of TCP flags set, for example packets with the SYN-FIN flag set at the same time or FIN-URG-PSH or URG-ACK-PSH-RST-SYN-FIN at the same time. All of these combinations of TCP flags are illegal and should never be together as part of a legitimate packet. So without further ado lets talk about Filter Lists.\nFilter Lists are defined under the Firewall section of the JUNOS configuration. Prefix Lists which are groups of networks, IP address ranges, or single hosts such as 1.1.1.1/32 are defined in these lists. These lists can later be used in as many Filter Lists as you define.\nBelow I will show you the actual Filter Lists as it looks in the configuration and some of the commands to create the list. For brevity I have opted to only show some of the commands used in creating the list as they are basically repetitive. The important thing to remember is that like all Access-Lists the terms in the Filter List are evaluated from top to bottom so it is important that the last term be an allow all statement otherwise the anti-spoofing filter will block all communication even legitimate communication.\n[edit] john#set policy-options prefix-list rfc1918-prefix-list 192.168.0.0/16 [edit] john#set policy-options prefix-list rfc1918-prefix-list 172.16.0.0/12 [edit] john#set policy-options prefix-list rfc1918-prefix-list 10.0.0.0/8 [edit] john# edit firewall [edit firewall] john# edit filter anti-spoofing [edit firewall filter anti-spoofing] john# edit term block-rfc1918 [edit firewall filter anti-spoofing term block-rfc1918] john# set from source-prefix-list rfc1918-prefix-list [edit firewall filter anti-spoofing term block-rfc1918] john# set then log discard [edit] john# show policy-options prefix-list rfc1918-prefix-list { 10.0.0.0/8; 172.16.0.0/12; 192.168.0.0/16; } [edit firewall] john# show filter anti-spoofing { term block-rfc1918 { from { source-prefix-list { rfc1918-prefix-list; ## \u0026#39;rfc1918-prefix-list\u0026#39; is not defined } } then { log; discard; } } term block-fin-urg-psh { from { protocol tcp; tcp-flags fin,psh,urg; } then { log; discard; } } term block-syn-fin { from { protocol tcp; tcp-flags fin,syn; } then { log; discard; } } term block-urg-ack-syn-fin-rst-psh { from { protocol tcp; tcp-flags urg,ack,psh,rst,fin,syn; } then { log; discard; } } term block-icmp { from { protocol icmp; icmp-type-except echo-reply,unreachable,source-quench,time-exceeded; } then { log; discard; } } term accept-all { then accept; } } Remember to apply the Filter-List to the interface with the following command:\n[edit] john#set interfaces fe-0/0/0.0 family inet filter input anti-spoofing Here is a related Article on ACL\u0026rsquo;s\n","date":"2009-06-14T21:10:02Z","permalink":"https://johnburns.io/post/introduction-to-filter-list-for-junos/","section":"post","tags":null,"title":"introduction-to-filter-list-for-junos"},{"categories":null,"contents":"New TechCast Posted I have been busy lately, I am in the middle of a Data Center migration at work, which is eating up hours of my personal time, and I have a million other projects on the burner. I have fresh content coming but in the mean time, I did a TechCast on Junos, please view the video at http://www.exiletv.com.\nUntil Next time\n","date":"2009-06-13T01:51:42Z","permalink":"https://johnburns.io/post/new-techcast-posted/","section":"post","tags":null,"title":"new-techcast-posted"},{"categories":null,"contents":"gopher I have been continuing to setup the bbs software on bbs.techinvasion.net. I have added irc, gopher, finger, and ident functionality. I encourage all of you to drop by and experience this neat software. The really neat thing about this BBS software is that it connects you to a world of forums and message boards that can only be accessed using BBS software. If you are running firefox I encourage you all to go to gopher://bbs.techinvasion.net. This will let you view the forums and posts, although it doesn\u0026rsquo;t look the same as it does through a telnet session, it is still very interesting.\n","date":"2009-02-04T14:19:14Z","permalink":"https://johnburns.io/post/gopher/","section":"post","tags":null,"title":"gopher"},{"categories":null,"contents":"Blast From the Past - BBS.Techinvasion.net Recently as a project cleaning up some old files and software, I came across a software disk for an old BBS I used to run. This got my interest peaked as I wondered if there were still BBS systems Alive and well on the internet. Information on BBS systems was few and far between in my research and it took me a while to make some headway. Eventually I came across http://Synchro.net� BBS software. This software is very similar to old school dos BBS\u0026rsquo;s. I installed the software which was no small feet�given the inadequate build instructions. Once the system was built and installed I had allot of fun setting up classic door games such as Trade wars and others.\nI also discovered that Dove-net and Fido-net are still alive and well, and there are a great many BBS�s connected all over the world. If the internet is a vast global city such as Coruscant (in Star Wars) then BBS�s and protocols such as telnet and gopher are its seedy underworld. An eclectic grouping of forgotten protocols running on forgotten systems, used by a hand full of lost souls who still cling to the web as it was. I had allot of fun setting up this BBS and I would like to use it in some way as a fun addition to part of my site.\nIn the spirit of the above and to old memories and a simpler if not better time I want to announce that telnet://bbs.techinvasion.net is open for business, with door games and all. Accounts are free, and I have even put up a forum for people to request firmware and various other things that they might need for a networking project. I hope everyone has as much fun using the system as I had creating it and I hope to see everyone in a session of Trade Wars.\n","date":"2009-02-02T11:12:17Z","permalink":"https://johnburns.io/post/blast-from-the-past-bbs-and-door-games/","section":"post","tags":null,"title":"blast-from-the-past-bbs-and-door-games"},{"categories":null,"contents":"Rotary Pools for Semi-Static NAT / Port range Forwarding Cisco routers have a very robust network address translation feature set.The NAT software allows you to control translation with access-list, route-maps, and destination pools.With the wide array of commands, it is sometimes difficult for beginners and experts to figure out how to combine these elements to solve a problem.\nI have a small network at home for the computers in my house, and I find that some of the strangest configurations and explorations come about because I try to solve problems in a way that is cost affective with the limited broadband available to consumers.I recently purchased a CheckPoint UTM firewall appliance to add to my network.CheckPoint invented the stateful firewall and has one of the best firewalls in the market.I wanted to add this firewall to my network but I faced 2 main problems.\nThe first problem is that my ISP only offers 1 static IP, and my router connects with a WIC1-ADSL card.\nThe second problem Is that my router is also a call manager express server and therefore needs to be able to receive traffic destined for the router itself.\nNotice that the outside interface of the firewall has a private IP address.This is a necessity because my ISP only offers 1 static IP and it must be assigned to the router.This is a problem if I leave my router configured the way it was with port overloading enabled, all the traffic not specifically forwarded via the router will be dropped at the Cisco which renders the inside firewall useless.\nSo the first thing I did was to change the following configuration from port overloading to static NAT Access-list 10\nOriginal Configuration\nip nat inside source list 10 interface dialer1 overload\naccess-list 10 permit ip 10.11.0.0 0.0.0.255 access-list 10 permit ip 192.168.10.0 0.0.0.255 New Test Configuration\nip nat inside source static 10.11.0.1 interface dialer1 The problem with the above configuration is that it forwards all packets to the firewall.This means that packets from my VOIP provider destined for the call manager software on the router itself were being forwarded to the firewall.This is a big problem and one that stumped me for a while.In order to fix this problem I decided to use Destination Lists.Destination Lists allow the router to evaluate incoming connections based on an access-list and translate the packets matching the criteria to hosts in a specific pool.\nThe interesting thing about this technique is that you can have as many pools and destination lists as you want, which means that you can use this technique to translate ranges of ports to different hosts.I know many newbies to Cisco routers look for a port range forwarding mechanism similar to what is available on consumer home gateways and routers like those from D-Link and Linksys.The following configuration allows all ports and protocols to be forwarded to the firewall except for any traffic from the VOIP provider.\nip host sip.broadvoice.com 98.98.200.12 ! ! ip nat inside source list 10 interface Dialer1 overload ! ip nat pool nonvoip 10.11.0.1 10.11.0.1 netmask 255.255.255.0 type rotary ! ip nat inside destination list 101 pool nonvoip ! ! access-list 10 permit ip 10.11.0.0 0.0.0.255 access-list 10 permit ip 192.168.10.0 0.0.0.255 ! Access-list 101 deny ip host 98.98.200.12 any Access-lsit 101 permit ip any any Lets take the above from the beginning.\nThe first line above code, hard codes the ip address of the Broadvoice server.\nThe second line configures the NAT for port address translation just like a normal PAT configuration.\nThe next line creates a rotary pool called nonvoip with the ip address ofthe outside firewall as the only IP address in the pool.\nThe 4th line in the configuration tells the router to check Access-list 101 and translate packets that match that access-list to the rotary pool nonvoip.\nAccess-list 10 is used to PAT the VOIP network And the 10.11.0.0 network which is used for the external interface on the firewall. Access-list 10 is required for nat to function.\nAccess-list 101 tells the router to exclude all traffic from the NAT process, but send every other protocol and port to the outside interface of the checkpoint firewall.\nThe above configuration can also be easily modified to forward port ranges to different hosts on the network.Once you figure out that you can have as many destination pools as you want with as many access-lists as you want the combination of port forwarding options becomes almost endless.For instance the above can be modified as follows to forward a range of ports to two different hosts.\nip nat inside source list 10 interface Dialer1 overload ! ip nat pool groupA 10.11.0.1 10.11.0.1 netmask 255.255.255.0 type rotary ! ip nat pool groupB 10.11.0.2 10.11.0.2 netmask 255.255.255.0 type rotary ! ip nat inside destination list 101 pool groupA ! ip nat inside destination list 101 pool groupB ! access-list 10 permit ip 10.11.0.0 0.0.0.255 ! Access-lsit 101 permit tcp any any range 8000 9400 ! Access-list 102 permit tcp any any range 50 1024 ","date":"2008-12-22T16:23:41Z","permalink":"https://johnburns.io/post/rotary-pools-for-semi-static-nat-port-range-forwarding/","section":"post","tags":null,"title":"rotary-pools-for-semi-static-nat-port-range-forwarding"},{"categories":null,"contents":"Content Based Access Control \u0026ldquo;CBAC\u0026rdquo; In the beginning God created heaven and earth, and then he created routers, so packets could flow from one part of the earth to the other. As he rested he looked down on his creation and smiled for all was good. Packets were flowing from one interface to another. Then as he beheld his creation he watches as some pad packets decided to flow where they didn\u0026rsquo;t belong! So God created access-lists and again everything was as it should be, packets only flowed to areas where they belonged. After some time naughty packets found out that they could sneak by God�s great protectors of the network by setting the ACK bit in their headers.\nThe access-list thought that these packets were part of an ongoing conversation and allowed them to sneak past. To fix this problem God shook heaven and earth and created reflexive access-lists. With these new and improved protectors of Gods interfaces packets were only allowed through if they matched a rule created for traffic flowing in the other direction. With this new method, return packets would only be allowed through if they matched a dynamic rule created by the original outgoing packet. God set back and looked at his creation and all was as it should be. Then one day applications were created that used dynamic ports for return traffic. For instance a person connects to a server on port 80, and the server responds with a packet on a random port between 45000 and 62000. Since the return packets did not match the originating packets the return packets would be dropped.\nTo fix this new problem God created CBAC or Content Based Access Control. With this new enhanced type of security found in the Firewall Feature set, traffic is inspected at layer 4 on the way out, and a dynamic access-list is created inbound on the interface to allow the traffic to return. Since CBAC inspects traffic on a higher level of the OSI model it can understand protocols that use dynamic port assignment, it can glean useful information from upper layer protocols that will help it make intelligent state full firewalling decisions and improve security while reducing false positives. You can see how over the years the security that we use has become ever more sophisticated to combat the ever clever internet hacker.\nBelow I will show you how to use CBAC on your router, Keep in mind that CBAC is part of the firewall feature set so may require additional licensing if your organization has to upgrade the ios. Ip inspect is configured in two areas. The first thing you have to do is create an inspection rule, and define what higher layer protocols you want to inspect. The next thing you have to do is apply the rule in the outbound direction on the interface you want to protect. You must also have either an access-list applied in the inbound direction; the access-list can be blank. When configuring the inspection rule you can choose from a number of protocols to look at. For ip inspect to work and to fix the issue with reflexive access-lists you only have to inspect layer 4 protocols such as tcp and udp. However CBAC supports many higher level protocols such as http, SMTP, real-audio, and other session and presentation, layer protocols.\nHere is a config that shows some of the many possible protocols that can be inspected with CBAC. I have listed the two main ones at the top. Another tip, if you have sip phones with private nat\u0026rsquo;d addresses behind this router and you want them to connect outside you need the ip inspect sip command to translate that properly through nat.\nip inspect name cbac-example tcp ip inspect name cbac-example udp ip inspect name cbac-example vdolive ip inspect name cbac-example smtp ip inspect name cbac-example http ip inspect name cbac-example rtsp ip inspect name cbac-example sip ip inspect name cbac-example skinny ip inspect name cbac-example tftp ip inspect name cbac-example ftp ip audit po max-events 100 ! ! ! ! ! interface FastEthernet0/0 ip address 192.168.1.254 255.255.255.0 ip access-group from_internet in ip inspect cbac-example out duplex auto speed auto Here is a related article on ACL\u0026rsquo;s.\n","date":"2008-10-21T09:56:28Z","permalink":"https://johnburns.io/post/content-based-access-control-cbac/","section":"post","tags":null,"title":"content-based-access-control-cbac"},{"categories":null,"contents":"Introduction to access-lists part 2 In the second installment of our guide to access-lists we are going to talk a little about named access-lists, how they work, what the benefits are, and how using them allows us to create reflexive access-lists. Named access-lists are exactly what they sound like, they are an extended access-list that has a name instead of a number. One of the nice features of named access-lists is that each line of the access-list has a number. this way you can delete just one line in an access-list without removing the whole access-list. You can create a named access list by using the following command.\n#ip access-list extended (name goes here) The neat thing about named access-lists is that when you do a show access-list command you see number s next to the lines in the acl. This allows you to add or remove lines without deleting the whole access-list.\ntest#sh ip access-list extended ip access-list example 10 permit ip any any 20 deny tcp any any eq 80 30 permit udp any any eq 53 Reflexive access-lists allow you to filter connections based on session. Reflexive ACL\u0026rsquo;s are part of the ip plus feature set and was the first attempt to create a statefull inspection firewall on routers. Before the invention of reflexive access-lists the only way we had to allow stateful return traffic from the internet was by using the establish keyword. The problem with the established keyword is that the router only checks for the ack bit on the packets. The ack bit is set on packets once the 3 way handshake has been completed. the problem with this is that it does not do anything for udp packets since those connections are stateless, and it is very easy for hackers to set the ack bit. To get around this problem Cisco invented the reflexive access-list.\npermit tcp any any eq 80 established Reflexive access-lists are very easy. I have added the code for the access-list below. Basically reflexive access-list are made up of two parts. The first part, is the access-list that filters outbound traffic. This access-list is made up of statements that allow outbound traffic. the key part here is the reflect statement. What this means is that you want to reflect that packet in another access list.\nIn my example below I reflected the statements in an access-list called dynamic. Now I created two access-lists. I created an inbound access-list to allow static inbound traffic to my webserver. I created an outbound access-list to allow traffic from my lan to the internet. I told my inbound access-list to check the reflexive entries before blocking traffic using the evaluate command. This is all there is too it. With these simple commands you can commands you can configure a statefull firewall to protect your network from harm. As good as this is though it isn\u0026rsquo;t perfect. It doesn\u0026rsquo;t work for application which use dynamic port numbers for return traffic. To solve this problem cisco added layer 4 inspection and refined reflexive access-lists in what they call Content Based Access Control or CBAC. However CBAC is part of the ios fw feature set and is a topic for another time.\ninterface FastEthernet0/0 description WAN Interface ip address 192.168.0.1 255.255.255.0 ip access-group internet_in in ip access-group lan_out out duplex auto speed auto ! ! ip access-list extended internet_in remark Internet----\u0026gt;lan traffic permit tcp any any eq 80 permit tcp any any eq 443 evaluate dynamic ! ! ip access-list extended lan_out remark inside-----\u0026gt;internet traffic permit tcp any any eq www reflect dynamic permit tcp any any eq 443 reflect dynamic permit tcp any any eq 22 reflect dynamic permit tcp any any eq ftp reflect dynamic permit tcp any any eq telnet reflect dynamic permit tcp any any eq pop3 reflect dynamic permit tcp any any eq nntp reflect dynamic permit tcp any any eq smtp reflect dynamic ! ! ","date":"2008-10-16T12:47:21Z","permalink":"https://johnburns.io/post/introduction-to-access-lists-part-2/","section":"post","tags":null,"title":"introduction-to-access-lists-part-2"},{"categories":null,"contents":"Introduction to access-lists part 1 Today I would like to take some time and talk about security. I want to discuss access-lists, extended access-lists, reflexive access-lists, and CBAC or content based access control. Learning how to properly use access-lists is so crucial to becoming a good network administrator. They are vital to securing your network and as you progress with your studies you will find that access-lists are used quite extensively in routing, QoS, and other important things.\nAccess-lists are used to match traffic and can be applied in either the in or out direction. It is important to note that the direction is from the perspective of the interface. For instance on a switch port IN would be coming into the switch or traffic being sent to the switch, whereas OUT would be the traffic the switch sends to the device connected to the port. So think of it like this: OUT means traffic flowing out of the switch, while IN means traffic flowing into the switch. See I knew you would get it, it\u0026rsquo;s very easy stuff.\nThere are two basic kinds of access-lists extended and standard. Access-lists over 100 inclusive are extended access lists, while access-lists numbered 99 and less are standard access-lists. Standard access lists can only filter based on ip address, while extended access-lists can filter based on layer 3 protocols such as tcp, udp, gre, and others. They can also filter based on tcp/udp port numbers. Lets take a look at an access list :\naccess-list 1 permit any any access-list 2 permit host 127.0.0.1 0.0.0.255 any access-list 3 deny 10.0.0.0 0.0.0.254 any access-list (1-99) (permit/deny) (source) (destination) All of these are standard access-lists, let*s take them apart in detail. The first part is the command access-list this is followed by either a permit/deny the next entry is the source and can be any, it can be a individual ip host x.x.x.x or it can be a network 192.168.1.0 0.0.0.255 The last part is a wild card mask which is the opposite of a subnet mask. Remember that standard access-lists can only filter based on source and or destination, but not any other information. If you want to filter on more than source and destination you can choose extended access-lists. Extended access-lists can filter on much more and take a slightly different format.\nAccess-list 101 permit tcp any any eq 443 Access-list 101 deny udp any any eq 500 Access-list 101 permit gre any any Lets have a look at some of the possible options that the Cisco IOS gives you to match packets, if you don\u0026rsquo;t understand all of the options or know how to use them at first, don\u0026rsquo;t worry. These kind of things look useless or seldom used at first, however as you progress you will make use of most of these options.\n#access-list 102 ? deny Specify packets to reject dynamic Specify a DYNAMIC list of PERMITs or DENYs permit Specify packets to forward remark Access list entry comment !\n#access-list 102 permit ? \u0026lt;0-255\u0026gt; An IP protocol number ahp Authentication Header Protocol eigrp Cisco\u0026#39;s EIGRP routing protocol esp Encapsulation Security Payload gre Cisco\u0026#39;s GRE tunneling icmp Internet Control Message Protocol igmp Internet Gateway Message Protocol ip Any Internet Protocol ipinip IP in IP tunneling nos KA9Q NOS compatible IP over IP tunneling ospf OSPF routing protocol pcp Payload Compression Protocol pim Protocol Independent Multicast tcp Transmission Control Protocol udp User Datagram Protocol !\n#access-list 102 permit tcp any any ? ack Match on the ACK bit dscp Match packets with given dscp value eq Match only packets on a given port number established Match established connections fin Match on the FIN bit fragments Check non-initial fragments gt Match only packets with a greater port number log Log matches against this entry log-input Log matches against this entry, including input interface lt Match only packets with a lower port number neq Match only packets not on a given port number option Match packets with given IP Options value precedence Match packets with given precedence value psh Match on the PSH bit range Match only packets in the range of port numbers rst Match on the RST bit syn Match on the SYN bit time-range Specify a time-range tos Match packets with given TOS value urg Match on the URG bit \u0026lt;cr\u0026gt; !\n#access-list 102 permit tcp any any eq 80 ? ack Match on the ACK bit dscp Match packets with given dscp value established Match established connections fin Match on the FIN bit log Log matches against this entry log-input Log matches against this entry, including input interface option Match packets with given IP Options value precedence Match packets with given precedence value psh Match on the PSH bit rst Match on the RST bit syn Match on the SYN bit time-range Specify a time-range tos Match packets with given TOS value urg Match on the URG bit \u0026lt;cr\u0026gt; !\nThis has been a brief intro to access lists. In the next Installment we will talk a little bit about named access-lists and how they can be used to construct reflexive access lists. Reflexive access-lists can be used to create dynamic entries in an access-list based on some event or matching criteria, and can be really important tool for securing a network. Also named access-lists allow you to easily manage a large access-list more easily by allowing you to change an entry or change the order of the acl without rewriting removing and rewriting the entire access-list.\nOne last thing*. Access-lists are applied to an interface by using the following command:\n#Config t (config )# Int fastethernet 0/1 (Config int)# Ip access-group in Or (Config int)# Ip access-group out ","date":"2008-10-15T21:12:35Z","permalink":"https://johnburns.io/post/introduction-to-access-lists-part-1/","section":"post","tags":null,"title":"introduction-to-access-lists-part-1"},{"categories":null,"contents":"Replace a running config without reloading The new Cisco IOS 12.4 train has many new features that any engineer will find useful; one of the features that fix a pain point for me is the new config options available in 12.4. Have you ever been in a situation where an entered configuration does not work as expected? Now usually you have to back out the configuration one command at a time and hope for the best. Sometimes you may even reach a point where you can not completely remove a configuration without reloading the device, this is the case sometimes when trying to remove sub interfaces. Now if this is a data center or work environment then you may not be able to reload the router.\nIt is for situations just like these that Cisco changed the configure command. If you have ever used the copy startup-config running-config command you know that this command does not replace what is running but instead merges the two configurations which often times will create a bigger mess.\nCisco has added the configure replace command. This command will go through the configuration line by line and replace your configuration with the configuration you specify and it will go through the config as many times as it takes to back out all of the differences and replace them with the file specified. The amazing thing about this command is that it does not interrupt the operation of the router, so you can rollback changes without affecting business continuity.\nHere is an excerpt from my router running the command to replace the running configuration with the startup configuration:\nLord_Yu# configure replace ? archive: URL of config file that will replace running-config cns: URL of config file that will replace running-config flash: URL of config file that will replace running-config ftp: URL of config file that will replace running-config http: URL of config file that will replace running-config https: URL of config file that will replace running-config null: URL of config file that will replace running-config nvram: URL of config file that will replace running-config pram: URL of config file that will replace running-config rcp: URL of config file that will replace running-config scp: URL of config file that will replace running-config snmp: URL of config file that will replace running-config system: URL of config file that will replace running-config tftp: URL of config file that will replace running-config xmodem: URL of config file that will replace running-config ymodem: URL of config file that will replace running-config Lord_Yu# configure replace nv Lord_Yu# configure replace nvram:? nvram:ifIndex-table nvram:persistent-data nvram:private-config nvram:startup-config Lord_Yu# configure replace nvram:sta Lord_Yu# configure replace nvram:startup-config ? force Forcibly replace without prompting for user input ignorecase Ignore case list List the commands applied in each pass time Time for which to wait for confirmation Lord_Yu# configure replace nvram:startup-config This will apply all necessary additions and deletions to replace the current running configuration with the contents of the specified configuration file, which is assumed to be a complete configuration, not a partial configuration. Enter Y if you are sure you want to proceed. ? [no]: y Total number of passes: 0 Rollback Done ","date":"2008-10-04T12:03:20Z","permalink":"https://johnburns.io/post/replace-a-running-config-without-reloading/","section":"post","tags":null,"title":"replace-a-running-config-without-reloading"},{"categories":null,"contents":"Working a lot! I have been working a lot lately, we are in the proccess of designing a new data center with all the ifs ands and buts included in that ordeal. I am in the proccess of writing several write ups. On spanning tree:\n\u0026ldquo;load balancing spanning tree using different trunks\u0026rdquo; BGP implementation and design considerations. IGP routing protocol deep dive. ","date":"2008-09-29T15:52:09Z","permalink":"https://johnburns.io/post/working-a-lot/","section":"post","tags":null,"title":"working-a-lot"},{"categories":null,"contents":"Encrypting GRE tunnels In our Last article we looked at creating GRE tunnels between networks to allow non routable traffic to pass between remote offices.� GRE tunnels are a great solution however the traffic passing inside these tunnels is not encrypted and thus could be intercepted by unauthorized parties. In this article we are going to look at tunneling GRE inside of IPSEC. This will allow us to get the benefits of GRE and the security of IPSEC.\ncrypto isakmp policy 10 #create crypto policy file authentication pre-share #use pre shared key crypto isakmp key integer address 192.168.1.2 #address of remote tunnel ! ! ! #use aes encryption and comp-lzs conpression. use transport mode. crypto ipsec transform-set myset esp-aes esp-md5-hmac comp-lzs ! mode transport # transport mode tells IPSEC not to create a tunnel, # this is used when you are using IPSEC for # encryption only and not for tunneling. ! crypto map mymap 10 ipsec-isakmp # create the crypto map set peer 192.168.1.2 # the peer must match the ISAKMP statement set transform-set myset # use the encyption we defined above match address match-gre # encrypt only packets in GRE tunnel ! ! ! ! interface Tunnel0 ip address 172.20.1.1 255.255.255.252 keepalive 10 3 tunnel source FastEthernet0/0 tunnel destination 192.168.1.2 tunnel path-mtu-discovery crypto map mymap # crypto map must be applied to tunnel ! ! ! ! interface FastEthernet0/1 description LAN INTERFACE ip address 10.0.0.254 255.255.255.0 ip nat inside duplex auto speed auto ! ! ! ! interface FastEthernet0/0 description Internet Interface ip address 192.168.1.1 255.255.255.0 ip access-group allow-gre in ip nat inside duplex auto speed auto crypto map mymap # crypto map must be applied to tunnel and public interface ! ! ! ! ip access-list extended allow-gre permit gre any any # allow gre through the firewall permit esp any any #allow esp for ipsec through the firewall permit udp any any eq 500 #allow udp port 500 through which ipsec also uses ! ! #access-list to match tunnel traffic. #This access list must be in the form (my public ip) (destination public ip) ip access-list extended match-gre permit gre host 192.168.1.1 host 192.168.1.2 log ","date":"2008-09-08T14:21:11Z","permalink":"https://johnburns.io/post/encrypting-gre-tunnels/","section":"post","tags":null,"title":"encrypting-gre-tunnels"},{"categories":null,"contents":"Create a GRE tunnel between endpoints Many time it is necessary to link a remote office to your main site and today we have many technologies to accomplish this task. We have IPSEC tunnels, IP-IN-IP tunnels, and GRE or Generic Routing Encapsulation Tunnels.\nEach type of connectivity offers advantages and disadvantages. Some of these tunnels can even be overlaid on top of one another. For instance IPSEC can be used in a transport mode, which allows you to use the encryption with other tunnels or protocols. For this article we are going to discuss GRE tunnels. GRE is unique as tunneling technologies go in that is started out as a proprietary protocol developed by Cisco and later adopted as a standard. GRE was invented as a way of encapsulating non routable protocols in IP which is a routable protocol. In this way protocols such as multicast (this include OSPF, EIGRP), and other protocols like IPX could be tunneled across routable links.\nGRE offers several advantages today when used as a tunnel to connect private LANs. The main advantages are the ability to carry multicast traffic, i.e. routing protocols across the internet. For instance, lets say you had a main office in London, which has Frame Relay links to 15 offices in Europe, and you have your headquarters in Washington D.C. with a MPLS network of 25 offices across North and South America. Now suppose due to the costs of bandwidth and particularly the cost of private connection such as frame across the pond, you decided to go with a 45mbps T3 line. Between London and D.C. Now you could connect these offices with an IPSEC VPN however if you did this you would be limited to building static routes for each network on each side of the ocean, this is not a very scalable solution and does not allow you the advantages of a dynamic routing protocol. This solution may even limit you should you decide to add a second T3 later say to an office in Madrid. With dynamic routing protocols, the traffic would automatically swing to the Madrid office if something were to happen to the link between D.C. and London. The solution to this problem is to use GRE tunnels, since GRE tunnels pass all types of traffic you can easily run a dynamic routing protocol, like OSPF or EIGRP. These protocols will allow seamless easy route adjustments when a route goes down.\nConfiguring GRE tunnels is easy with a few simple steps you will be on your way. Before we can talk about configuring GRE tunnels we need to discuss exactly what the requirements for GRE are! GRE is a protocol, like IP you need to make sure this protocol is allowed through your firewall if you want to terminate a GRE tunnel. GRE to be more exact is protocol 47. Please be mindful that this is not port 47 but protocol 47. Allowing port 47 through your firewall will not allow GRE to work.\nSteps to configure a GRE tunnel\ncreate access-list on outside interface to permit GRE create tunnel interface interface Tunnel0 ip address 172.20.1.1 255.255.255.252 keepalive 10 3 tunnel source FastEthernet0/0 tunnel destination 192.168.1.2 tunnel path-mtu-discovery ! ! ! ! interface FastEthernet0/1 description LAN INTERFACE ip address 10.0.0.254 255.255.255.0 ip nat inside duplex auto speed auto ! ! ! ! interface FastEthernet0/0 description Internet Interface ip address 192.168.1.1 255.255.255.0 ip access-group allow-gre in ip nat inside duplex auto speed auto ! ! ! ! ip access-list extended allow-gre permit gre any any ","date":"2008-09-08T13:20:02Z","permalink":"https://johnburns.io/post/create-a-gre-tunnel-between-endpoints/","section":"post","tags":null,"title":"create-a-gre-tunnel-between-endpoints"},{"categories":null,"contents":"Cisco 3750 Switches now include a time domain reflectometer! How many time have�you wanted to know how long a cable run was? Now if you are running cisco 3750 switches you can find out by issuing the following commands you can see how long that cable run really is.\nSwitch# test cable-diagnostics tdr interface gigabitethernet0/2\rTDR test started on interface Gi0/2\rA TDR test can take a few seconds to run on an interface. Use \"show cable-diagnostics tdr\" to read the TDR results.\rSwitch#show cable-diagnostics tdr interface gigabitEthernet 0/2\rTDR test last run on: Dec 10 09:05:10\rInterface Speed Local pair Pair length Remote pair Pair status --------- ------ ---------- ------------ ------------ ---------- Gi0/2 auto Pair A 22 +/- 4 m N/A Open Pair B 21 +/- 4 m N/A Open Pair C 5 +/- 4 m N/A Open Pair D 20 +/- 4 m N/A Open ","date":"2008-09-08T10:43:11Z","permalink":"https://johnburns.io/post/cisco-3750-switches-now-include-a-time-domain-reflectometer/","section":"post","tags":null,"title":"cisco-3750-switches-now-include-a-time-domain-reflectometer"},{"categories":null,"contents":"Checkpoint \u0026mdash;\u0026gt; juniper VPN Recently at work we had a remote site go down. The site was on an ancient pix 506e vpn firewall router. We were in the proccess of switching to a different vpn solution. because of this we had a new Juniper ssg20 firewall device on site.\nNow I thought this would be an easy job, configure the Juniper to connect to our checkpoint r55 box the same as the pix had done before! Man was I surprised to realize that the Juniper did not like the r55. The r55 sends proxy id\u0026rsquo;s through the tunnel for every device connecting. Now the interesting this is that the r55 uses the supernet for the address requesting access through the vpn. On the cisco pix and asa devices, this does not much matter. So for instance if you hav 10.0.0.0/24, 172.16.2.0/23 and 192.168.0.0/24 on 1 side all trying to access a remote site through the Juniper, the checkpoint send the juniper proxy id\u0026rsquo;s for each of those networks. Now like I said the cisco determines what traffic matches the tunnel with access-lists and doesn\u0026rsquo;t much care what the proxy ID says. The juniper on the other hand does! If it sees a proxy id for say a host that is not part of the tunnel, it will tear down the tunnel!!!!\nYou can imagine this is a big problem. So what has to be done is that you have to go to autoike and add a gateway for each network that is on the other side. Make sure you also go to advanced and select the checkbox for proxy ID. Once this box is checked enter the information for source and destination. the best way to do this is to check the event logs on the junipers and put in exactly what it says the received proxy ID is.\nOnce you do this the tunnel will come up. the only other issue is to go to the network \u0026ndash;\u0026gt; routing __\u0026gt; destination tab and add a route for each network that you need to go to the tunnel interface.\nThats it, 6 hours of work and the answer was very simple once you figure it out.\n","date":"2008-09-04T10:46:51Z","permalink":"https://johnburns.io/post/checkpoint-juniper-vpn/","section":"post","tags":null,"title":"checkpoint-juniper-vpn"},{"categories":null,"contents":"Cisco 3640 and wic-1adsl speed problems I recently decided to plug my wic-1adsl card into a 3640 router because my 2620 had a power supply failure. I noticed that the cisco 3640 ran very slow, and speed tests topped out at 2.6mbps downlink speeds. For a while I couldn\u0026rsquo;t figure out why a router that is faster with more memory would run slower than my 2620 router. I later discovered the reason for the slowness was because of a bandwidth limit on the nm-1fe1r2w card I was using to give me wic slots.\nsh controller atm0/0 you will see\nDSCC4 Clockrates: DSCC0 = 2600000 (ATM0/0) DSCC1 = 1000000 (ATM0/0) Now This is why I am only getting about 2.5mbps download.\nIf you change the setting ie:\nint atm0/0 clockrate aal5 5300000 then do a\nshow controller atm0/0 you get :\nDSCC4 Clockrates: DSCC0 = 5300000 (ATM0/0) DSCC1 = 1000000 (ATM0/0) Now my speed tests are topping out at about 5.2mbps and change.\nNow here is the interesting part. On the 3640 53000 is as high as I can go, while on my 2620 the output is as follows.\ncisco 2620 (output of sh controller atm0/0)\nDSCC4 Clockrates: DSCC0 = 8000000 (ATM0/0) DSCC1 = 8000000 (ATM0/0) My guess is that each nm card reserves a certain amount of bandwidth for the interfaces on each card. The card I was using had 1 fe port 1 tokenring port and 2 wic slots, my guess is that those other interfaces used or reserved some of the total bandwidth for the connection. I am thinking that a nm-2w card might solve the problem, however I have not yet tested this theory.\n","date":"2008-09-02T14:03:39Z","permalink":"https://johnburns.io/post/cisco-3640-and-wic-1adsl-speed-problems/","section":"post","tags":null,"title":"cisco-3640-and-wic-1adsl-speed-problems"},{"categories":null,"contents":"Video tutorial on IPV6 You can download or watch the full video at IPV6\u0026lt;embed bgcolor=\u0026quot;#FFFFFF\u0026quot; ","date":"2008-05-15T15:47:58Z","permalink":"https://johnburns.io/post/video-tutorial-on-ipv6/","section":"post","tags":null,"title":"video-tutorial-on-ipv6"},{"categories":null,"contents":"liveplasma.com I found a really cool site that displays related content in a visual way, so if for instance you type in an Artist name like Pinback, it will show all related artists in a very cool visual way, very similar to some of the visual displays for Digg.com\n","date":"2008-02-09T22:16:44Z","permalink":"https://johnburns.io/post/liveplasmacom/","section":"post","tags":null,"title":"liveplasmacom"},{"categories":null,"contents":"Outlook 2003 error setting up profile after uninstalling office 2007 This is a problem that I run into quite alot as most new PCs come with the Office 2007 trial pre-installed. When you try to setup Outlook 2003 for the first time you get the following error\n\u0026ldquo;There was an error locating one of the items needed to complete this operation. It might have been deleted\u0026rdquo;\nIn order to fix this error you have to rename \u0026lsquo;mapisvc.inf\u0026rsquo; one in\nC:\\Windows\\System32,\nand one in\nC:\\Program Files\\Common Files\\System\\MSMAPI\\1033\nOnce you rename these files start outlook again and it will reinstall the correct versions of the file and allow you to setup the users outlook profile.\n","date":"2008-02-06T16:12:19Z","permalink":"https://johnburns.io/post/outlook-2003-error-setting-up-profile-after-uninstalling-office-2007/","section":"post","tags":null,"title":"outlook-2003-error-setting-up-profile-after-uninstalling-office-2007"},{"categories":null,"contents":"New Forums We have added a new forums section to techinvasion.net. We hope these forums will�become a big part of the site and allow all the users to participate, ask questions, and get answers. The link to the forums is along the left hand side of the page in the categories section. You can also go directly to the forums by going to /forum.\nWe are also looking for writers to post relevant articles such as the ones that have been posted by our 3 writers�so far. If you are interested in writing for techinvasion.net please send an email to admin@techinvasion.net.��\n","date":"2008-01-31T18:33:19Z","permalink":"https://johnburns.io/post/new-forums/","section":"post","tags":null,"title":"new-forums"},{"categories":null,"contents":"Fixing the SKU01A.CAB and other office cab file issues Anyone who has used office 2003 has noticed that when switching domains or logging in as a new user Microsoft Office ask you to insert the cd to cache files needed to start. In some cases it asks for files from older office versions that have been upgraded, sometimes you don\u0026rsquo;t even have the original cd. To solve this problem you can make a simple change to the registry that tells office not to expect cached files off the installation cd.\nTo do this you have to change a registry value to tell office not to cache files off of the CD. To fix the problem you have to change �a registry key. set the value of the following key to \u0026ldquo;0\u0026rdquo;\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Office\\11.0\\Delivery\\ \u0026ldquo;CDCache\u0026rdquo;=\u0026ldquo;0\u0026rdquo;\nI have added a registry file that will fix this for you, just click the link below\nFix_CDCACHE.REG\n","date":"2008-01-30T21:47:43Z","permalink":"https://johnburns.io/post/fixing-the-sku01acab-and-other-office-cab-file-issues/","section":"post","tags":null,"title":"fixing-the-sku01acab-and-other-office-cab-file-issues"},{"categories":null,"contents":"An overview of CISCO IOS Security features as related to packet filtering. �The Cisco IOS has many powerful security features that enable network engineers to protect their internal network. The Cisco IOS is capable of intrusion detection, deep packet inspection, and stateful firewall features. Setting up IPS allows the admin to push intrusion detection to the network edge. The Cisco IPS feature set can scan for spyware, viruses, worms, Trojans, and network intrusions by receiving updated signature files from Cisco. If a packet or series of packets matches a particular signature the router can, send an alert, drop the packet, or reset the connection of the offending user. In this way the network engineer can better protect the network by acting on suspicious packets before they can pose a risk to the network infrastructure, another advantage of pushing IPS duties to the network edge is it allows offending packets to be dropped before they take up finite network resources. �In large networks as much as 10 percent of network resources could be consumed by packets that ultimately will be dropped for security reasons deeper in the network.\nA lot of engineers prefer to use dedicated systems for network security such as Pix and ASA devices. However the Cisco recommended methodology is to filter packets as close to the egress point as possible thus saving network resources and enhancing security. In times past it was considered better to apply security features on dedicated devices deeper in the network while putting as few strains on the edge routers as possible. This methodology used to be a necessity as routers typically had much less horse power and a significant amount of CPU cycles and memory was used just routing and switching packets, add to that the wide spread use of Port address translation which requires a large amount of CPU cycles and memory to maintain the port translation state table and the situation was dire. It was not uncommon to see a branch office level router such as a 2500, or 2600 series overloaded by P2P programs which open up thousands of ports for connections. In these situations a single user could easily destabilize the network and cause the router to drop packets from the load. Cisco realizing the changing world of networking and the relative cheapness of CPU power released the XM series routers as a stopgap measure until the new integrated services platform routers were available such as the 2800 and 3800 series routers. These new routers are more powerful than ever and allow IPS, stateful firewall features, and deep packet inspection to be performed at the network edge thus enhancing security and availability of network resources.\nBesides the IPS features the Cisco routers can also perform CBAC or Content Based Access Control. With CBAC the router can inspect TCP, UDP, and ICMP packets for fragments and irregularities. The IOS can also inspect sever layer 7 protocols, and with the latest 12.4 IOS and current generation of routers this list has expanded to many many layer 7 protocols. When using CBAC the router monitors the outgoing packets on an interface, and dynamically creates holes in the inbound access list to allow only packets that match up to the outgoing request. This means that CBAC enables the IOS to perform true stateful Firewalling.� In the 12.4 IOS CBAC uses deep packet inspection to determine the true protocol of the packet and better protect the network from intrusion. With deep packet inspection the router will recognize an FTP packet and scan it for known issues even if the packet arrives on a port other than the standard FTP control port. The IOS also uses access lists to secure interfaces and drop unwanted traffic at the network edge which will prevent network resources from being wasted.\nI hope this brief overview of the Cisco IOS security methodology as it relates to packet filtering was informative. I will follow up later with a more technical article on how to configure CBAC stateful firewalling, and IPS signatures on the Cisco router.\n","date":"2008-01-29T22:30:27Z","permalink":"https://johnburns.io/post/cisco-ios-firewall-security/","section":"post","tags":null,"title":"cisco-ios-firewall-security"},{"categories":null,"contents":"Cisco WIC-1ADSL config for 1800 series router and ios 12.4 This config is for the Cisco 1800 series router running IOS 12.4. IOS 12.4 has some command and syntax changes in reguards to interfaces and configuration commands for PPPOE. This config was submitted by my good friend Pedro Rivera.\nversion 12.4 service timestamps debug datetime msec service timestamps log datetime msec no service password-encryption ! hostname Router ! boot-start-marker boot-end-marker ! ! no aaa new-model ! resource policy ! mmi polling-interval 60 no mmi auto-configure no mmi pvc mmi snmp-timeout 180 ip subnet-zero ip cef ! ! ! ! ip name-server 205.152.144.23 ! ! interface FastEthernet0/0 description Internal Lan ip address 10.10.10.254 255.255.255.0 ip nat inside ip virtual-reassembly ip tcp adjust-mss 1452 duplex auto speed auto ! interface FastEthernet0/1 no ip address shutdown duplex auto speed auto ! interface ATM0/0/0 no ip address no atm ilmi-keepalive dsl operating-mode auto ! interface ATM0/0/0.1 point-to-point pvc 8/35 pppoe-client dial-pool-number 1 ! ! interface Dialer0 ip address negotiated ip mtu 1452 ip nat outside ip virtual-reassembly encapsulation ppp dialer pool 1 dialer-group 1 ppp authentication chap callin ppp chap hostname xxxxxxxxxxxxx@xxxxxxxxxxxxxx.net ppp chap password 0 xxxxxxxxxxxxxxx ! ip classless ip route 0.0.0.0 0.0.0.0 Dialer0 ! ip http server no ip http secure-server ip nat inside source list 1 interface Dialer0 overload ! access-list 1 remark INSIDE_IF=FastEthernet0/0 access-list 1 remark SDM_ACL Category=2 access-list 1 permit 10.10.10.0 0.0.0.255 dialer-list 1 protocol ip permit ! ! control-plane ! ! line con 0 line aux 0 line vty 0 4 login 111 ","date":"2008-01-28T21:50:46Z","permalink":"https://johnburns.io/post/cisco-config-wic-1adsl-2/","section":"post","tags":null,"title":"cisco-config-wic-1adsl-2"},{"categories":null,"contents":"Configuring WIC-1ADSL on Cisco 2600 with PPPOA and PPPOE Configuring a Cisco router to use the WIC-1ADSL card is one of the most commonly asked question by people in the Cisco forums. There are some interesting and compelling reasons to use a WIC card instead of connecting PPPOE through the ADSL modem in bridged mode. One of the most compelling reasons is the ability to use advanced QOS features such as interleaving and fragmentation. Because the DSL WIC card shows up as an ATM WAN interface, the router is able to perform those advanced Quality of Service features. The overhead of encapsulating a packet in PPPOE and sending it to the modem over some length of cable is also a reason to use a WIC card instead of the modem.\nIt is important to realize that with most ISP\u0026rsquo;s you can configure the connection to use either PPPOA or PPPOE, the difference in configuration is very subtle however it can save you a couple of bits of overhead as PPPOE is encapsulated more time Than PPPOA. So without further a due:\nFirst the PPPOE config:\nThe below is a complete config\nRed is directly related to the WIC DSL config\nGreen is the rest of the config needed for a bare minimum working config.\n################################################################################## Using 5173 out of 29688 bytes ! version 12.3 service timestamps debug datetime msec service timestamps log datetime msec service password-encryption ! hostname Lord_Yu ! boot-start-marker boot-end-marker ! logging buffered 56000 debugging no logging console enable password 7 xxxxxxxxxxxxxxx ! memory-size iomem 15 clock timezone est -5 clock summer-time est recurring 4 Sun Mar 1:00 4 Sat Oct 1:00 no aaa new-model ip subnet-zero ip cef ! ! no ip domain lookup ip domain name techinvasion.net ! no ip bootp server vpdn enable vpdn-group 1 request-dialin protocol pppoe ! interface ATM0/0 no ip address ip route-cache flow no atm ilmi-keepalive bundle enable ! dsl operating-mode auto pvc 8/35 encapsulation aal5mux ppp dialer dialer pool-member 1 ! ! interface FastEthernet0/0 description LAN INTERFACE ip address 10.0.0.254 255.255.255.0 ip nat inside ip tcp adjust-mss 1460 duplex auto speed auto ! interface Ethernet1/0 no ip address shutdown half-duplex ! interface Dialer1 description ADSL WAN DIALER ip address negotiated ip mtu 1492 ip nat outside encapsulation ppp ip route-cache flow ip tcp adjust-mss 1452 dialer pool 1 dialer-group 1 no cdp enable ppp authentication chap pap callin ppp chap hostname xxxxxxx@xxxxxxxxxx.net ppp chap password 7 xxxxxxxxxxxxx ppp pap sent-username xxxxxxxx@xxxxxxxxxx.net password 7 xxxxxxxxxxxx ppp ipcp dns request ! ip nat translation timeout 3600 ip nat translation tcp-timeout 1200 ip nat translation finrst-timeout 15 ip nat translation syn-timeout 45 ip nat inside source list 10 interface Dialer1 overload no ip http server no ip http secure-server ip flow-export destination 10.0.0.3 2055 ip classless ip route 0.0.0.0 0.0.0.0 Dialer1 permanent ! ! ! ip access-list extended inbound deny ip 0.0.0.0 0.255.255.255 any log-input deny ip 10.0.0.0 0.255.255.255 any log-input deny ip 127.0.0.0 0.255.255.255 any log-input deny ip 169.254.0.0 0.0.255.255 any log-input deny ip 172.16.0.0 0.15.255.255 any log-input deny ip 192.168.0.0 0.0.255.255 any log-input deny ip 224.0.0.0 15.255.255.255 any log-input logging 10.0.0.3 access-list 10 permit 10.0.0.0 0.0.0.255 ! line con 0 password 7 xxxxxxxxxxx line aux 0 line vty 0 4 password 7 xxxxxxxxxx login transport input telnet ssh line vty 5 password 7 xxxxxxxxxxxx login ! ntp clock-period 17180335 ntp server 192.43.244.18 ntp server 129.6.15.28 ! end\nThe Following is the PPPOA Config:\nIt is not the full config only a partial config.\nNotice how the dialer access-list is different and notice tha lack of the VPDN commands at the top of the config:\nversion 12.3 hostname Lord_Yu ! boot-start-marker boot-end-marker ! logging buffered 4096 debugging no logging console enable password 7 ! memory-size iomem 15 clock timezone est -5 clock summer-time est recurring 4 Sun Mar 1:00 4 Sat Oct 1:00 no aaa new-model ip subnet-zero ip cef ! no ip domain lookup ip domain name techinvasion.net ! interface ATM0/0 no ip address ip route-cache flow no atm ilmi-keepalive bundle enable ! dsl operating-mode auto pvc 8/35 encapsulation aal5mux ppp dialer dialer pool-member 1 ! ! interface FastEthernet0/0 description LAN INTERFACE ip address 10.0.0.254 255.255.255.0 ip nat inside ip tcp adjust-mss 1460 duplex auto speed auto ipv6 address autoconfig ipv6 enable ! interface Ethernet1/0 no ip address shutdown half-duplex ! interface Dialer1 description ADSL WAN DIALER ip address negotiated ip mtu 1492 ip nat outside encapsulation ppp ip route-cache flow ip tcp adjust-mss 1452 dialer pool 1 no cdp enable ppp authentication chap pap callin ppp chap hostname xxxxxxxxx@xxxxxxxx.net ppp chap password 7 xxxxxxxxx ppp pap sent-username xxxxxxx@xxxxxxxx.net password 7 xxxxxxxx ppp ipcp dns request ! ip nat inside source list 10 interface Dialer1 overload no ip http server no ip http secure-server ip flow-export destination 10.0.0.3 2055 ip classless access-list 10 permit 10.0.0.0 0.0.0.255 dialer-list 1 protocol ip permit ","date":"2008-01-28T20:59:12Z","permalink":"https://johnburns.io/post/cisco-config-wic-1adsl/","section":"post","tags":null,"title":"cisco-config-wic-1adsl"},{"categories":null,"contents":"Vista Complete-PC backup to network share The real magic of the new Vista backup tool is the second option Complete-PC backup. This feature takes advantage of the HAL independence of Vista and allows you to backup your entire system at one time using the magic of volume shadow copies to backup open files. The backup is also stored in a virtual machine file which means that you can boot, run, and extract files from your backup using Microsoft Virtual PC. This is a really neat feature! If the previous feature isn�t enough for you Microsoft will let you restore your pc by booting to the Windows Vista install DVD and selecting the restore option.\nThis is the greatest reason to use the new Windows complete-pc backup feature over other third party backup solutions. As it lets you restore you pc intact with all software serial codes and files ready to rock. However Microsoft in their wisdom has added some obstacles to using what would otherwise be a great tool. When you select the complete pc backup feature you are not given the option to backup to a network drive. This is a big problem as most people do not have a spare hard drive sitting in their desktops waiting for a backup. It is also a problem from an IT administrative viewpoint. As an administrator I would like to have 1 centralized location to store all of my client PC backups. This is also a problem for people at home with nas storage devices as they may have opted for 1 drive without partitions as they expected to keep all backups and data files on the nas drive.\nIn order to get around this problem Microsoft has provided a command line version of the windows backup utility called wbadmin.exe. This version of the utility is far more powerful than the generic GUI version intended for typical users and allows you to backup to a network drive among other things. Remember that although you can backup to a network drive the backup file must be on a local drive it is to be used by the Windows bootable CD to restore the drive!Lets take a quick look at the switches available to us on the CLI version of the utility, but first lets cover a few caveats. The command line version of the utility does not prompt for credentials, it attempts to access the network share using the credentials of the current user. This means that if you are not backing up to a windows domain member server, in the case of a consumer Linux powered NAS drive, then you must have an account on the nas box that has the same username and password as you are using on the Vista machine. The CLI version of the command must be run from an elevated command window.Let�s take a look at the utility now that we have covered the basics.C:\\Users\\John\u0026gt;wbadmin.exewbadmin 1.0 - Backup command-line tool(C) Copyright 2004 Microsoft Corp.ERROR - Command incomplete. See list below.For more help, type wbadmin \u0026lt;command\u0026gt; -help\u0026mdash;- Commands Supported \u0026mdash;-START BACKUP \u0026ndash; Run a backup immediatelySTOP JOB \u0026ndash; Stop currently running backup or recoveryGET VERSIONS \u0026ndash; List details backups recoverable fromGET ITEMS \u0026ndash; Lists items backed up for a backupGET STATUS \u0026ndash; Lists status of currently running job\nC:\\Users\\John\u0026amp;gt;C:\\Windows\\system32\u0026amp;gt; wbadmin start backup -backuptarget:\\\\server\\share\\ -include ** **:c: -drive letter to backup **wbadmin 1.0 - Backup command-line tool(C) Copyright 2004 Microsoft Corp.Retrieving volume information...This would backup volume Local Disk(C:) to \\\\server\\share\\.Do you want to start the backup operation?[Y] Yes [N] No yBackup to \\\\server\\share\\ is starting.Running shadow copy of volumes requested for backup.Running shadow copy of volumes requested for backup. ","date":"2007-11-12T23:42:07Z","permalink":"https://johnburns.io/post/vista-complete-pc-backup-to-network-share/","section":"post","tags":null,"title":"vista-complete-pc-backup-to-network-share"},{"categories":null,"contents":"Hacked Iphone goodness As promised here is some iPhone screenshots!!!.��\n","date":"2007-10-30T20:05:32Z","permalink":"https://johnburns.io/post/hacked-iphone-goodness/","section":"post","tags":null,"title":"hacked-iphone-goodness"},{"categories":null,"contents":"Iphone Fun I have spent the last couple weeks breaking the Iphone in every way possible. I Now have it running as a mail server. One of the great things about the iphone is that it is running mac os x leopard, which is just version 9 of the darwin kernel. That means that once you get out of the ch-rooted environment on the phone, you can install the BSD subsystem. The BSD subsystem basically just adds back all the unix tools we have come to know and love. After that it is just a matter of compiling an embedded version of apache or your web server of choice. Next you can use NFS shares to mount more available storage. I will post some pictures here of some interesting screen shots. The arm cpu in the phone is actually quite fast. This of course is all just for iphun ( pun intended) however it is nice to have shell access on the phone. I do a lot of networking for a living and it is nice to have ssh and telnet on my phone. This makes it much easier to program routers and do many other things\n#uname -a Darwin John Burns\u0026#39;s iPhone 9.0.0d1 Darwin Kernel Version 9.0.0d1: Wed Sep 19 00:08:43 PDT 2007; root:xnu-933.0.0.203.obj~21/RELEASE_ARM_S5L8900XRB iPhone1,1 Darwin# Macintosh:~ John$ uname -a Darwin Macintosh.local 9.0.0 Darwin Kernel Version 9.0.0: Tue Oct 9 21:37:58 PDT 2007; root:xnu-1228~1/RELEASE_PPC Power Macintosh Macintosh:~ John$ Very interesting to note the kernel version number on my leopard g4 vs the iphone. Anyways I am still fiddling with it, however if you want more Iphone hacks and an explanation of how to do them, please post a response to this post and I will write and upload the articles.\n","date":"2007-10-29T15:37:38Z","permalink":"https://johnburns.io/post/iphone-fun/","section":"post","tags":null,"title":"iphone-fun"},{"categories":null,"contents":"MIT student arrested for fake bomb An MIT student was arrested in Logan intl Airport for wearing a sweatshirt with a prototyping board on it and a 9 volt battery which lit up some led�s that said MIT course VI which is the numerical designation for computer and electrical engineering majors. The shirt which she has and has been wearing for a long time, was something that a class of students made as a project. The police surrounded her in the airport with automatic weapons and arrested her, then commented that she was lucky to be alive. As you can see from the link to the article below anyone who has half a brain can see that it is a piece of techno art. However I just wanted to post this to solicit your opinions about the fear of electronics in this country and the sad state of affairs. This is even worse considering that MIT is known for its research in embedded computers in clothing and the airport is right around the corner from MIT! Also she walked up to the airline desk and asked when a flight was coming in because she was picking up a friend. She did not even try to get through the security checkpoint.\nhttp://www.boingboing.net/2007/09/21/mit-student-arrested.html\n","date":"2007-09-22T13:20:18Z","permalink":"https://johnburns.io/post/mit-student-arrested-for-fake-bomb/","section":"post","tags":null,"title":"mit-student-arrested-for-fake-bomb"},{"categories":null,"contents":"2 m Moxon project. I�am in the process of designing a 20m moxon antenna. I like the moxon so much I decided to make a quick moxon for 2m tonight. I built it out of twine and 2 dowel rods. I wanted to see how cheap I could build one, and the total cost of this antenna is $4.28. Not bad for an antenna on the cheap. The moxon is a great antenna and the reason why it is well liked on�HF is because it exhibits the gain of a 2 element yagi antenna with the s/n rejection of a 3 element yagi! This antenna is easy to build and hand holding it you can tell which direction the local repeaters are. As you rotate the moxon away from the repeater, the signal disappears completely!\nFor more information about moxon antennas including some really amazing antennas visit http://www.moxonantennaproject.com/\n","date":"2007-09-19T22:34:35Z","permalink":"https://johnburns.io/post/2-m-moxon-project/","section":"post","tags":null,"title":"2-m-moxon-project"},{"categories":null,"contents":"Call of Duty 4 ","date":"2007-07-22T19:21:23Z","permalink":"https://johnburns.io/post/call-of-duty-4/","section":"post","tags":null,"title":"call-of-duty-4"},{"categories":null,"contents":"Life the Universe and Everything Today I realized that even though the world is cruel and unfair, irony is not lost. I realized this while I was sitting on hold with my ISP, and the rep came back on the line and told me the reason why I had to hold a little longer was because he himself was on hold\u0026hellip;\u0026hellip; 5 minutes later he hung up on me while transferring my call\u0026hellip;.?\n","date":"2007-07-09T17:47:25Z","permalink":"https://johnburns.io/post/life-the-universe-and-everything/","section":"post","tags":null,"title":"life-the-universe-and-everything"},{"categories":null,"contents":"Open Solaris 10 sandbox Thanks to those friendly people from Digg.com who decided it would be fun to bring my Solaris box to its knees by forking and other things to DDOS my Solaris zone. I have learned many ways of enhancing the security of Solaris zones. I have limited the Sandbox zone to 1% of total CPU usage. I have limited the total number of processes to 1000 and I have installed the Solaris Jass security hardening script. I plan to post many of my discoveries in the future. Work has been busy lately and it is on the burner of things to be done along with part 2 of solaris zones.\n","date":"2007-07-02T21:54:50Z","permalink":"https://johnburns.io/post/open-solaris-10-sandbox/","section":"post","tags":null,"title":"open-solaris-10-sandbox"},{"categories":null,"contents":"First Production ZFS server today I have plenty of small business clients and sooner or later they all face one big challenge. They all outgrow the initial 80GB tape drives that we put on their servers. The problem is that most of these are small businesses and most of them could just afford the initial network, and asking them to pony up $2000+ for a new tape drive or worse yet autoloader is out of the question.\nUntil recently we would try to switch them from full daily backups to full on Mondays and incremental the rest of the week. The problem with this is that this really only works up until about 120GB. After that you are looking at more than 2 tapes. If someone has to switch tapes on a Monday while users are changing files, it is very hard to get a consistent backup. This problem got me thinking, what is a relatively cheap way to get consistent backups of the server, retain more copies of the backups with less pace consumed, and be able to backup to more then two tapes without having backups run on data users are interacting with, which could stress the system, hurt performance, and cause inconsistent backups.\nMy solution was to purchase a low-end server like an HP ML-110. Put 2 500GB sata drives in the system, and 2 40GB drives with hardware raid 1 for the system OS files. I then installed Solaris 10 and made a ZFS pool with the two 500GB drives mirrored. I shared the ZFS pool with NFS and Samba (NFS for Unix and samba for windows 2003 servers). I have the servers do a full backup to the ZFS pool on Monday, which is about 200GB. The incremental backups the rest of the week is about 50GB total. I set the backups to overwrite the data each week, so as not to use up too much disk space. This brings full weeks backups to about 220GB with compression on the ZFS pool. I then take a snapshot of the entire pool on Saturday and keep that snapshot for 4 weeks. This means that even though I am overwriting the backup files each week. The snapshots only take up as much space as the differences, so for about 380GB of disk space I have 1TB worth of backups on this Solaris box. And it gets even better. I set the tape drive to backup from the Solaris box every day after the other servers dump their backups to it the previous night. Since the data is not live data the backups are consistent and also the backups can be done during the day so someone can insert tape after tape while people are in the building.\nThis is how ZFS has made life easier for me at one client site. This solution is scalable and priced at one-third the cost of a 400GB auto-loading tape drive. If this solution works out over the next couple of months I fully intend to make this my primary solution for those clients that can\u0026rsquo;t afford bigger tape drives.\n","date":"2007-07-02T21:43:15Z","permalink":"https://johnburns.io/post/first-production-zfs-server-today/","section":"post","tags":null,"title":"first-production-zfs-server-today"},{"categories":null,"contents":"TV Networks Just Don\u0026rsquo;t Get it I t seems to me that the big four tv network either don\u0026rsquo;t understand what people want or simply don\u0026rsquo;t care. If you look at the cable networks you have stimulating things to watch like Nip Tuck, Dexter, Sleeper Cell, Battlestar Galactica, Monk, and too many other good dramas to mention. However when you turn to the major networks they simply show one copied worn out reality show after another.\nUntil recently I assumed they just didn\u0026rsquo;t get it, but then I found out that it cost the networks on average 4 to 8 times as much money to produce a script based show. Kind of makes you think doesn\u0026rsquo;t it?\n","date":"2007-07-02T20:11:52Z","permalink":"https://johnburns.io/post/tv-networks-just-dont-get-it/","section":"post","tags":null,"title":"tv-networks-just-dont-get-it"},{"categories":null,"contents":"Things I Wish I Knew About Solaris When I First Started. Solaris 10 is a very powerful scalable operating system that feels tightly integrated and highly responsive. However for those of us with a strong Linux or FreeBSD background Solaris can feel a little unfamiliar and even downright confusing. This post is made up of a few things I wish I knew before I started my Solaris 10 adventure. I hope it will make things a little easier for those of you wanting to take the plunge into a true enterprise operating system.\nMore\u0026hellip;\n1.That annoying backspace!!!!\nIf you are wondering how to get the backspace key to work in Solaris you can type one simple command. It should make life much easier for you.\n#stty erase ^h\nThe (^h) is what is displayed when you use the backspace key.\n2.How do I enable Samba?\nTo enable Samba simply issue the following commands:\n#vi /etc/sfw/smb.conf\nEnter your samba config entries here\n#reboot?\nWhen Solaris 10 boots it will check /etc/sfw for the smb.conf file, If that file is present it will enable samba automatically.\nHow do I turn the graphical login on and off on bootup? If you want the gui to not start when the system boots you can issue the following commands.\n#/usr/dt/bin/dtconfig �d\nThe above command will disable auto gui on boot.\n#/usr/dt/bin/dtconfig �e\nAs you can probably guess if �d disables the gui �e enables it.\nHow do I scan for a network card and load the driver? If you are coming from Linux or FreeBSD the process of loading a network card driver may seem very alien. In order to check for any network cards on the system for which you have drivers you can issue the following commands\n#ifconfig �a plumb\nThe plumb part of the command will look for any network cards for which you have drivers and attempt to attach the driver to the hardware. You can check to see if any cards were found by using the following command.\n#ifconfig �a\nIf any new network cards were found they will now show in the above command. The trick here is to get the network card to load automatically every time the computer starts in order to do this you must create the following file.\n#vi /etc/hostname.interface-name\nsome examples of this are:\nHostname.rtls0Hostname.vfe0\nInside this file you need to put the hostname of the computer.\nIf the hostname is workstation1.techinvasion.net the file should look like the following:\n#cat /etc/hostname.vfe0Workstation1#\nThese Are just some of the things that I have learned that I wish I knew when I started my adventure into Solaris. I will add more little tips to this page as I find more little things to add.\n","date":"2007-07-02T00:33:49Z","permalink":"https://johnburns.io/post/things-i-wish-i-knew-about-solaris-when-i-first-started/","section":"post","tags":null,"title":"things-i-wish-i-knew-about-solaris-when-i-first-started"},{"categories":null,"contents":"Linux Distro OS-tan Wallpapers An OS-tan is an anime character representing a particular OS. Here is one artists rendition of a dozen Linux distro OS-tan made for desktop background use, including Linux-tan. The sizes are up to 1600X1200. The Ubuntu-tan is amazing!\nread more | digg story\n","date":"2007-06-26T02:21:09Z","permalink":"https://johnburns.io/post/freaking-awesome-linux-distro-os-tan-wallpapers/","section":"post","tags":null,"title":"freaking-awesome-linux-distro-os-tan-wallpapers"},{"categories":null,"contents":"IP Filter and FreeBSD IPF is a very robust firewall included in FreeBSD by default. This is a statefull firewall with logging capabilities that can also be used to NAT a local network in situations where the FreeBSD box is the router. The best way to get IPF working is to compile the kernel with support built in. Although the default kernel has support through the use of loadable modules, compiling the options into the kernel provide a more flexible and robust system.\nThe first thing you want to do is download the FreeBSD source. This can be done by using the ports tree to install cvsup, and modifying the standard-supfile for your release. Once this is done you can run the following command:\ncvsup �g �L2 ./standard-supfile\nOnce the source tree is installed you will want to add the options to the kernel source.\n#cd /usr/src/sys/conf/i386/\nee ./GENERIC You will want to add the following line for a secure and efficient? IPF installation.\noptions IPFILTER\n#turn on support for\nIP Filter options\nIPFILTER_LOG\n#Turn on logging by default options\nIPFILTER_DEFAULT_BLOCK\n#change state from default allow to default block\nThe last command is very important as it tells the kernel to drop all packets on all interfaces by default. This means that you will have to explicitly allow all packets, even on loopback interfaces like LO\nAfter these commands are entered and the file is saved you can compile the kernel by using the following commands\n#cd /usr/src\n#make buildkernel KERNCONF=GENERIC\n#make installkernel\n#shutdown �r now\nOnce the machine reboots you will have to edit the rc.conf file in order to set some configuration settings for IPF.\n#ee /etc/rc.conf\nipfilter_enable=\u0026ldquo;YES\u0026rdquo;\nStart ipf firewall ipfilter_rules=\u0026quot;/etc/ipf.rules\u0026quot;\nloads rules definition text file ipmon_enable=\u0026ldquo;YES\u0026rdquo;\nStart IP monitor logipmon_flags=\u0026quot;-Ds\u0026quot;\nD = start as daemon s = log to syslog v = log tcp window, ack, seq n = map IP \u0026amp; port to names If you have a LAN behind this firewall that uses the reserved private IP address ranges, then you need to add the following to enable NAT functionality:\ngateway_enable=\u0026ldquo;YES\u0026rdquo;\nEnable as LAN gateway ipnat_enable=\u0026ldquo;YES\u0026rdquo;\nStart ipnat function ipnat_rules=\u0026quot;/etc/ipnat.rules\u0026quot;\nrules definition file for ipnat Now it is time to look at a sample firewall rule file and see how IP Filter works. ? On a system with 1 network card, such as a web server or such.\n#cat /etc/ipf.rules\n#######################\n##loop back interface, do not restrict this interface it will break system!!!#####\npass out quick on lo0\npass in quick on lo0\n###interface rl0 internet and lan interface#####\nPass in quick on rl0\n#needed because of implicit block in kernel\nblock in on rl0\n#without the quick command it will match this rule but check to see if it matches others\nblock in quick on rl0 from 192.168.0.0/16 to any\n#anti spoofing do not to use this if nic is on lan also\nblock in quick on rl0 from 172.16.0.0/12 to any\n#anti spoofing do not to use this if nic is on lan also\nblock in quick on rl0 from 10.0.0.0/8 to any\n#anti spoofing remember not to use this if nic is on lan also\nblock in log quick on rl0 from 127.0.0.0/8 to any\n#anti spoofing loopback network\nblock in log quick on rl0 from 20.20.20.0/24 to any #anti ? spoofing\nblock in log quick on rl0 from any to 20.20.20.0/32 #anti spoofing\nblock in log quick on rl0 from any to 20.20.20.255/32 #anti� spoofing\npass out quick on rl0 proto tcp from 10.0.0.1 to any keep state\npass out quick on rl0 proto udp from 10.0.0.1 to any keep state\npass out quick on rl0 proto icmp from 10.0.0.1 to any keep state\n#################################################\nNow let�s break this file down one line at a time to understand what is does. Remember that we used the default block all command when we recompiled the kernel. This is secure by default because it operated on the bases that everything is blocked unless we specifically let in a packet or protocol. The first thing we have to do is tell IP Filter that it should allow everything in and out of the lo interface. Lo is the loopback interface and is used for interproccess communication. Lo is always 127.0.0.1.\npass out quick on lo0\npass in quick on lo0\nThe above two commands? allow traffic to flow freely in and out of the loopback interface. Let me ask you a question for the sake of learning. Look at the rules below and think about what you think will happen when a user tries to connect to this web server.\nBlock in on rl0 proto tcp from any to any\u0026gt;\nPass in on rl0 proto tcp from any to any port = 80 Now if you are familiar with Cisco access-lists and other similar firewalls you may have said: the packet is a web request packet, a syn packet to be precise. This packet will match the first rule and be dropped since all www packets are tcp.\nWon�t you be surprised when the packet skips on past the first rule and connects to your web server. In IPF a packet?is evaluated against 1 rule at a time from top to bottom. But the fate of the packet is decided based on the last rule it matches. If you want a packet to match only a single rule and be passed or dropped, you need to add the keyword quick to your command. Such as �\npass out quick on lo0\npass in quick on lo0\nNow you may ask �Why would this behavior be useful?� This behavior is useful for many situations but let�s consider one example. In this example the computer the firewall is protecting is a FreeBSD desktop computer which hosts� not services. So we want to block all incoming packets that have no state table entry(more on state tables later). In order to do this you have the following rule.\nblock in quick on rl0\nThe above command will work however it will not give you any information about the packet that was dropped. Now say for example you want to block all unsolicited packets but you also want to log any packets that are trying to carry out a spoof attack on your network. In this case the following commands would be more useful.\nblock in on rl0\nblock in log quick on rl0 from 127.0.0.0/8 to any #anti spoofing loopback network In this situation the packet will be dropped but if the packet is a packet from the internet masquerading as a loopback packet it will be dropped and logged. This is why this behavior is so important, because it gives you the flexibility to have more control over your firewall with a minimum of effort.\nKeep State\nNow you will notice in our example config file above we had blocked all incoming connections. You may be asking yourself? how the config works if every reply coming back is blocked. The key to that config working is in the keep state keyword. Let�s take a look at the following snippet of code:\npass out quick on rl0 proto tcp from 10.0.0.1 to any keep state\npass out quick on rl0 proto udp from 10.0.0.1 to any keep state\npass out quick on rl0 proto icmp from 10.0.0.1 to any keep state\nYou will notice in the above code that we allow all tcp, udp, and icmp packets to go to the internet. The important part of the above commands is the keep state command. What this does is tell the computer to track that tcp session and keep a table of all outgoing requests. When the packet hits the interface which is a reply to a session which we opened up. The computer will dynamically add a rule to allow this tcp stream to enter the computer. In this way all unsolicited ? packets are dropped except those packets responding to requests initiated by you.\nNow let�s say that you want to host an apache web server on your desktop for testing purposes. It is very simple to modify the? config to allow incoming connections by adding the following line\nPass in quick on rl0 proto tcp from any to any port = 80 flags S keep state\nJust make sure this line goes above the block in lines so that it is processed first to make sure that packet goes through. It is important to remember that this command can be modifies for any service you want to run. Here are some examples below\nPass in quick on rl0 proto udp from any to any port = 53 keep state\n#dns server\nPass in quick on rl0 proto tcp from any to any port = 22 flags S keep state\nIt is also important to note that the flags S command only allows in lone syn flags on packets. What this means is that it will only let in the initial connection request not just any packet that is part of a stream. This helps protect against man in the middle attacks as well as keep packets that will be dropped from taking up resources in your tcp stack.\nBack to blocking ports, there is one keyword that can help us increase the stealth of our firewall. In a typical exchange when a packet is blocked we decrement the TTL like the RFC�s say we should. But what this does is show that there is a hop here and it announces to the world that we exist. Instead of using the above rule we could rewrite it such that it does not decrement the TTL of the packet. To the rest of the world it looks as if the computer does not exist.\nWe can do this by changing the following commands from\nblock in on rl0\nblock in log quick on rl0 from 127.0.0.0/8 to any\n#anti spoofing loopback network\nto\nblock in on rl0\nblock in log quick on rl0 fastroute from 127.0.0.0/8 to any #anti spoofing loopback network?\nNotice I added the Fastroute keyword. This tells the firewall not to decrement TTL of a packet when it is blocked.\nNow let me show you how to activate the rule set for IPF once you have created your file. To activate a rule set issue the following command.\nThe ipf command is used to load your rules file. Normally you create a file containing your custom rules and use this command to replace in mass the currently running firewall internal rules:\nipf -Fa -f /etc/ipf.rules -Fa means flush all internal rules tables.\n-f means this is the file to read for the rules to load.\nThis gives you the ability to make changes to your custom rules file, run the above IPF command, and thus update the running firewall with a fresh copy of all the rules without having to reboot the system. This method is very convenient for testing new rules as the procedure can be executed as many times as needed.\nThis is just a basic introduction to IPF rules. There are many more techniques and things that can be done such as rule groups which can speed up the rule processing on large access-lists. And variable substitution which can help make writing complex rules sets easy. I will cover NAT and the various commands to monitor the firewall such as ipfstat in another installment of the how-to. I hope you enjoyed it!\n","date":"2007-06-25T00:27:21Z","permalink":"https://johnburns.io/post/ip-filter-and-freebsd/","section":"post","tags":null,"title":"ip-filter-and-freebsd"},{"categories":null,"contents":"Solaris Zones Part 1 So what is a zone?\nA zone is analogous to a VMware machine but with some distinct advantages as well as some disadvantages. To start explaining zones lets start by comparing it to VMware since most people are familiar with VMware. VMware is a software program that runs on a host operating system,. This could be Windows, Linux, or a custom kernel in the VMware ESX series. VMware provides a hardware abstraction layer which it uses to create mini virtual computers. The advantages of this setup are as follows: You can create a custom virtual computer designed for the operating system and application you want to run. This means that you have a very high level of customizability which allows you to tailor the virtual machine to provide the best performance for the program you want to run. VMware also supports ? many different operating systems. You could run VMware on a Linux box and then run Windows 2003 in one virtual machine, and a FreeBSD NFS server in another. From the point of view of the guest operating systems, they believe they are on standalone hardware and are unaware of the host OS and other guest OSs which may be running.\nSo this is a good thing and it provides a fair amount of flexibility, but you pay for this flexibility in several key areas. The first area is licensing costs. VMware is not free. While they do have free versions for testing and evaluation, all production software comes with a license. The second area in which you pay is overhead. VMware while a very good virtualization tool has a good amount of overhead. This is because it must present a complete environment to each guest operating system installed. This means that it must schedule CPU time IO and other resources for each of the guest operating systems in real time. This can really be a drag. The other area in which you pay a price is transparency. The cost of the ability to run multiple operating systems on one machine is that each operating system must be segregated to its own virtual hardware emulation layer. What this means is that while VMware has some distinct advantages in lowering the cost of infrastructure it does not lower the cost of human resources and administration.\nNow what does that mean Administration Cost. Simply put, even though you save the cost of purchasing multiple machines by virtualizing them, from the administrative standpoint each operating system must be monitored and maintained as if it was a separate machine. This means from the host operating system you can see that VMware is using %90 of your CPU time, but you dont know which of the virtual computers is using what. You also do not know what processes are running on each virtual machine or what the load is of each machine. This means that each machine must be logged into individually and administered as if it was the only operating system on the machine.\nSo now lets look at a situation in which VMware might not be the best solution. I think we all agree the VMware is a good choice when you need to have multiple operating systems on one machine. However what if you have a web services company and you have 1 machine running DNS, one machine running DHCP, one machine as a NFS server for file sharing, and 1 server to host your website. Now lets further assume that you want to virtualize and that as a web services company you are running some type of UNIX/POSIX system. If this is the case you could standardize on Solaris 10 with zones and not only save money on TCO (total cost of ownership) of the hardware itself but also on the IT resources needed. A Solaris zone is a container stored in a folder on a Solaris UNIX machine that can have either a complete copy of the Solaris Operating system, including its own file system. It can also share some common directories ? (read only) with the Solaris machine and be installed with as little as 82mb of disk space. The Solaris zones will boot up as if they were the only Solaris OS on the machine and they are also completely isolated from the host machine which means a web server security breach will not affect the other zones in any way.\nNow what are the advantages of this? In this scenario each zone would be completely secure and segregated from the host Solaris OS. Each zone would have its own kernel with its own drivers and its own processes. Solaris will even leverage its Mainframe heritage too allow you to split up the physical hardware into resource pools. So say you wanted to have 2 cpus for the system, 2 cpus for oracle 10g, and 2 cpus for the web server this could be done without a problem. There are also some other advantages to Solaris zones. You can browse to each zone through the file tree. For example\nIf the zone is install at /export/zone1 then while the zone is running I can copy files to the / or root of that zone by browsing to? /export/zone1/root/\nIt is also important to note that /etc /usr /mnt/ and all other folders and file systems can be found under /export/zone1/root/ as well.\nSo this is a big advantage files can be copies between zones and the host computer with little trouble. This is also important because while you can browse to that zone from the host computer, the zone cannot browse out of its path. This means great security while providing ease of administration. You can see from this example how easy it would be to browse to /export/zone1/root/var/admin ? and view the logs for that system without ever logging in to it.\nIt is also important to note that each system has its own root account as well as other system and user accounts. Another big advantage of Solaris zones is that any of the system monitoring commands such as iostat vmstat and prstat, will show all processes in each zone and there memory utilization cpu time in the case of vmstat and prstat (prstat is like top for Linux Admins). It will also show disk IO in the case of iostat, and as always? you can filter the input for each zone or display all info with zones separated. So you can see how this saves money and reduces TCO by allowing one login to manage all systems that are virtualized. You can also create zones to experiment or roll out new services in as a testing measure.\nIndeed this website is running in a Solaris zone. It uses Apache2 php5 and Mysql5.? PHP requires the installation of a lot of GNU software which I did not want mucking up my core Solaris system. So I installed it in a zone. Everything on this web server is isolated in that zone which makes keeping my system orderly and tidy an easy job. It also means that any misconfigurations or other errors that may have left my entire system vulnerable in the past is less of a problem. The worst thing that can happen is an attacker neutralizes my web zone, in which case I can restore from a mirror zone, I keep for failover.\nStay tuned for part two in which I will have some good examples of configuring Zones.\nEND PART 1\n","date":"2007-06-24T16:25:52Z","permalink":"https://johnburns.io/post/solaris-zones-part-1/","section":"post","tags":null,"title":"solaris-zones-part-1"},{"categories":null,"contents":"ZFS filesystem on Solaris Here is a flash video thanks to http://www.opensolaris.org, which I think explains some of the features of zfs very well. This video should have you wanting more! I am working on a comprehensive tutorial about zfs which should cover this great file system in more detail.\n","date":"2007-06-24T03:30:14Z","permalink":"https://johnburns.io/post/solaris-zones/","section":"post","tags":null,"title":"solaris-zones"},{"categories":null,"contents":"Blog Migrated I just upgraded the blog, It has been migrated from a 800mhz FreeBSD based system to a 2ghz Sun Solaris 10 based system with ZFS storage. The web server is also running in its own isolated container/zone. In migrating I have decided not to import all of the old articles, Instead? I will go through them and pick the best ones to include here.\nStay Tuned More to come!\n","date":"2007-06-24T03:15:01Z","permalink":"https://johnburns.io/post/blog-migrated/","section":"post","tags":null,"title":"blog-migrated"},{"categories":null,"contents":"Laptop crashes when power source is changed fix Like most people who have complained about this problem I had recently upgraded to mandrake 9.2 and was surprised by the lack of problems usually associated with upgrading distro\u0026rsquo;s. My surprise turned to horror when I realized the my laptop a Dell Inspiron 8000 would freeze as soon as I unplugged the a/c adapter or plugged in the a/c adapter.\nAfter searching for days for the fix and listening to contradictory advice I had finally sorted out the good from the bad information and concluded that a kernel recompile was necessary. Imagine my surprise after recompiling and realizing that the very cool and professional looking graphical boot was gone. This took a whole 8 hours to sort out. This tutorial is geared specifically for Mandrake users, however the information and the steps for recompiling the kernel to fix the power problem will work on any distro. The tutorial will also seek to explain how the frame buffer sections of the kernel source work, so that you\u0026rsquo;re new kernel will have a clean looking high resolution console. The tutorial will also show mandrake users and users of other distro\u0026rsquo;s which use Bootsplash, how to modify their initrd image to boot up with a nice jpeg image.\nFirst things first, the cause of the freezing is that you\u0026rsquo;re particular laptop does not implement the apm bios correctly. So when the kernel boots up and uses apm the calls lock your bios. Unlike most posts in forums across the Internet, the problem is not the acpi interface but the apm. The problem is also exacerbated by the use of the local apic on uniprocessor systems and systems with Pentium 4 processors. So if you want to recompile the kernel the first thing to do is to download the kernel sources for your distro. If you have a distro like Mandrake which heavily modifies their kernel with programs like supermount you may want to use their kernel instead of the kernels at www.kernel.org.\nIf you are using mandrake an easy way to get the latest kernel sources is to click on your start menu in either KDE or Gnome then mouse over configuration then mouse over packages and finally click on install software. Once the RPMDrake window comes up you can type kernel into the search field. The search should bring up a number of things click on the latest kernel source file it should be an srpm. For those of you who do not want to use the distro\u0026rsquo;s kernel or for people who do not have an easy way of getting their kernel installed you will have to download either a rpm or a tar ball.\nOnce the kernel is installed you will have to switch to the kernel directory you can do this by typing cd /usr/src/linux (the following assumes you are using the root account). This command will take you to the source directory. If you have compiled a kernel previously you can type: make mrproper. Once this command is done you will have to configure the kernel, which you can do in several different ways. The first is to type make xconfig which will let you configure the kernel inside Xwindows. The second way is to type make menuconfig which will give a text based menu to configure the kernel. For the purposes of this tutorial I will be using make xconfig. So now the menu is on the screen in front of you and looking through all those options can seem like a daunting task. I will try to briefly explain hat each of the options is for and which ones we want to set for our purposes.\nThe menu is divided into many different sections which at first seem random but actually it is a very ordered system. The kernel is the machine which connects all of your programs to the hardware to put it in an over simplified way. You will notice that the options are split up with the processor and motherboard features in once section. Memory and block devices, eg Hard drives, in another. You will also notice a section for all of the networking options and so on. The first section which we need to modify to fix our freezing problem is the processor type and features section. Click on this section. You will notice this brings up another window with more options in it. The first option allows you to select what processor you are using, it is probably set to i386 generic. We are not here to change this setting, but since we are here it wont hurt to set it appropriately which might even give you a slight performance boost. Further on down you will see to options one option is to enable Toshiba laptop support, If you have a Toshiba laptop enable this feature. The next option asks whether you want to enable Dell laptop support, since I have a Dell I enabled this feature.\nA quick note about modules: The debate rages over whether a monolithic or modularized kernel is better. The truth is that each type of kernel has its own advantages and I find myself somewhere in the middle. By using all modules you will find that for instance loading a pcmcia card with module support will take a little longer to load and will use a little more Memory, however if you rarely use this pcmcia card it would be to your advantage to compile it as a module that way you do not have to keep the driver in memory the entire time. I will leave the decision on whether to make a monolithic or modularized kernel up to you, However certain things must be compiled in and not used as a module. For instance the file system that your root partition is on should be compiled into the kernel, compiling as a module will result in a kernel panic during boot.\nFurther down you will see an important option it says Local apic support on uniprocessors we want to disable this feature as it is one of the three things that contribute to the lockups. After selecting no to this question we can close this window by clicking main menu. The next section that we need to look at is the general setup section. Click on General Setup to enter this section now. The next thing that we must enable is pci hotplug support. Click on PCI hotplug Support now to enter the sub menu. Now in the new menu disable the first option Support for PCI Hotplug (experimental) after you have disabled this click main menu to return. Now scroll further down this window we want to disable Advanced Power Management Bios Support. After this is disabled scroll further down until you see acpi support which is the last thing on the list. Click on acpi support which brings up another menu. In this menu acpi support should be enabled and everything else as either a y or a m. Now that you are done with this window click main menu and click main menu again to return to the first menu. Now you have done everything you need to fix the crashing problems. You might also want to check out the file system tab and make sure what ever file system you are using as root is compiled in and not as just a module. After doing all of the following you might want to also go through each menu and turn off the drivers for hardware you don\u0026rsquo;t have or don\u0026rsquo;t plan to get. This will decrease the compiling time and size of your kernel tremendously. After going through the rest of the source code and setting everything to your liking the next step is to click save and exit. The window will disappear and save all your setting. The next step is to go back to the prompt and compile the kernel.\nThe kernel can be compile by typing two very simple lines at the prompt. Make sure you are in the source directory /usr/src/linux if you are not then get there.\n[root@localhost Linux]# make dep \u0026amp;\u0026amp; make clean \u0026amp;\u0026amp; make bzImage \u0026amp;\u0026amp; make modules\nafter this you will need to type one more thing:\n[root@localhost linux] # make modules_install \u0026amp;\u0026amp; make install\nAfter this completed which could take anywhere from 15 to 45 minutes you\u0026rsquo;re new kernel will be complete. You next have to edit your lilo.conf file /etc/lilo.conf and add a couple things.\nYour lilo.conf file should have a new entry at the bottom that has your new kernel number eg\nimage=/boot/vmlinuz-2.4.xx-xxmdkcustom (or something similar)\nlabel=(new name)\nroot=/dev/hda1 (or your equivilent)\nread-only\noptional\nappend=\n","date":"2004-01-31T21:40:22Z","permalink":"https://johnburns.io/post/laptop-crashes-when-power-source-is-changed-fix/","section":"post","tags":null,"title":"laptop-crashes-when-power-source-is-changed-fix"},{"categories":null,"contents":"About Me An enthusiastic troubleshooter, engineer, technologist, and team leader. I find myself constantly looking for the next challenge. I enjoy complex technological and social problem solving. Navigating the complexities of large organizations to create progress and forward momentum on complex projects are just some of the things I spend my days doing for organizations.\nStandard IT services to cloud first cutting edge organizations, leading teams to achieve excellence is a requirement for leaders in todays market. The modern associate wants to be part of a team with a clear mission and vision, and that requires leadership they can invest in to be successful. A leader of teams who design, manage, and implement large scale e-infrastructure and applications. My expertise is at the nexus of cloud, networking, and security infrastructure. I turn big ideas into secure infrastructure at scale,\nCurrent Role: AVP Network Services at Marriott Vacations Worldwide\nGitHub\n“All men dream: but not equally. Those who dream by night in the dusty recesses of their minds wake in the day to find that it was vanity: but the dreamers of the day are dangerous men, for they may act their dreams with open eyes, to make it possible.” – T.E. Lawrence\nExperience Years Title Company 2019-Present AVP Network Services Marriott Vacations Worldwide 2016-2019 Director Network Services Interval International 2011-2016 Manager Network Services Interval International 2008-2011 Sr. Network Engineer Interval International 2003-2008 Engineer IT VAR Best Buy for Business Interest Green Technology and sustainable agriculture I am very active in the aquaponics community. This technology allows for the farming of fish as a protein source, while utilizing a porous stone or clay medium to grow vegetables. This allows bacteria to filter the waste of the fish, while generating Nitrogen fertilizer which the plant roots in readily absorb. This allows rapid food production with minimal footprint and efficient use of fish waste as a source of energy.\nAmateur Radio While not as popular as it once was amateur radio is still in the forefront of IOT networking, satellite communications, digital communications technologies. I have been licensed for over 20 years, my call sign is KG4OLW and I have communicated with people all over the world as well as volunteered and trained to help with emergency communications during natural disasters and other emergencies.\nTypewriters I love collecting and restoring old typewriters. I have a number of them and when I can find them I usually buy them and restore them. I don\u0026rsquo;t keep most of them I just sell them on, but I feel proud to help restore some of these beautiful specimens before they can be trashed. We live in such as disposable culture these days it\u0026rsquo;s nice to be able to touch a product made out of steel more than 100 years ago that is still functional and will last for generations to come.\nWriting I enjoy reading quite a bit and I have started by hand at novel writing. While most of those stories are just for me. Eventually I may end up publishing one if it meets my standards. for now the endeavor is a personal one. I like most writers feel the need to get the story out so it stops bouncing around in my head.\nCertifications \u0026amp; Education CCNA - 2003/2008 JNCIA - 2016 ID# JPR00232130 FIU 2003 - Finance Florida Institute of Technology 2002-2003 Miami-Dade College 2000-2002 Web Applications 2bit.pro hammap.org ","date":"0001-01-01T00:00:00Z","permalink":"https://johnburns.io/about/","section":"","tags":null,"title":"About"},{"categories":null,"contents":" Email: John@techinvasion.net Phone: +01-3058783067 Websites Address hammap.org 2bit.pro www.techinvasion.net Social Linkedin QRZ Youtube ","date":"0001-01-01T00:00:00Z","permalink":"https://johnburns.io/contact/","section":"","tags":null,"title":"Contact"}]